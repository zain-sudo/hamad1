(this.webpackJsonpemployeetrainer=this.webpackJsonpemployeetrainer||[]).push([[0],{325:function(e,t,a){},326:function(e,t,a){},441:function(e,t,a){},677:function(e,t,a){e.exports=a(853)},829:function(e,t,a){},830:function(e,t,a){},833:function(e,t,a){},834:function(e,t,a){},836:function(e,t,a){},837:function(e,t,a){},838:function(e,t,a){},839:function(e,t,a){},840:function(e,t,a){},841:function(e,t,a){},842:function(e,t,a){},845:function(e,t,a){},846:function(e,t,a){},847:function(e,t,a){},848:function(e,t,a){},849:function(e,t,a){},850:function(e,t,a){},852:function(e,t,a){},853:function(e,t,a){"use strict";a.r(t);var n,r,i=a(0),s=a.n(i),o=a(71),c=a(261),l=a(31),u=a(36),d=a(38),m=a(37),p=a(61),v=a(5),g=a.n(v),h=a(12),f=a(216),E=a(105),b=a(100),y=a(391),C=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).code=null,n.token=null;var r=window.location.search,i=new URLSearchParams(r);return n.token=i.get("token"),n.code=i.get("code"),n.state={resourceStrings:{}},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.resourceStrings.errorMessage;return"401"===this.code&&(e="".concat(this.state.resourceStrings.unauthorizedAccess)),i.createElement("div",{className:"container-div"},i.createElement(f.a,{gap:"gap.small",hAlign:"center",vAlign:"center",className:"error-container"},i.createElement(f.a,{gap:"gap.small",hAlign:"center",vAlign:"center"},i.createElement(f.a.Item,null,i.createElement("div",{style:{position:"relative"}},i.createElement(E.a,{icon:i.createElement(y.a,null)}))),i.createElement(f.a.Item,{grow:!0},i.createElement(f.a,{column:!0,gap:"gap.small",vAlign:"stretch"},i.createElement("div",null,i.createElement(b.a,{weight:"bold",error:!0,content:e}),i.createElement("br",null)))))))}}]),a}(i.Component),S=a(127),k=a(211),w=a(453),x=a(33),D=a(84),O=a.n(D),T=new(function(){function e(){Object(l.a)(this,e),this.authorizationHeaderKey="Authorization",this.acceptLanguageHeaderKey="Accept-Language"}return Object(u.a)(e,[{key:"post",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(n);case 3:return n=e.sent,e.next=6,O.a.post(t,a,n);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(a);case 3:return a=e.sent,e.next=6,O.a.delete(t,a);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(n);case 3:return n=e.sent,e.next=6,O.a.put(t,a,n);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setupAuthorizationHeader(n);case 3:return n=e.sent,e.next=6,O.a.patch(t,a,n);case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(r.length>2&&void 0!==r[2])||r[2],e.prev=1,!n){e.next=6;break}return e.next=5,this.setupAuthorizationHeader(a);case 5:a=e.sent;case 6:return e.next=8,O.a.get(t,a);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCachedData",value:function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(r.length>2&&void 0!==r[2])||r[2],e.prev=1,!n){e.next=7;break}return e.next=5,this.setupAuthorizationHeader(a);case 5:(a=e.sent).headers["Cache-Control"]="max-age=1209600";case 7:return e.next=9,O.a.get(t,a);case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),e.abrupt("return",Promise.resolve(this.handleError(e.t0)));case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){return e.hasOwnProperty("response")?e.response:e}},{key:"setupAuthorizationHeader",value:function(){var e=Object(h.a)(g.a.mark((function e(t){var a=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.initialize(),e.abrupt("return",new Promise((function(e,n){var r={successCallback:function(n){t||(t=O.a.defaults),t.headers[a.authorizationHeaderKey]="Bearer ".concat(n),t.headers[a.acceptLanguageHeaderKey]=M.language,e(t)},failureCallback:function(e){console.error("Error from getAuthToken: ",e),window.location.href="/signin"},resources:[]};x.authentication.getAuthToken(r)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),I=function e(){Object(l.a)(this,e)};I.body="body",I.theme="theme",I.default="default",I.light="light",I.dark="dark",I.contrast="contrast",I.categoryNameMaxLength=100,I.categoryDescriptionMaxLength=300,I.lazyLoadEventsCount=50,I.maxWidthForMobileView=750,I.apiBaseURL=window.location.origin+"/api",function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Delete=2]="Delete",e[e.Unknown=3]="Unknown"}(n||(n={})),function(e){e[e.OK=200]="OK"}(r||(r={}));var N=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(I.apiBaseURL,"/cultureMetadata"),e.next=3,T.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(I.apiBaseURL,"/cultureMetadata/supportedcultures"),e.next=3,T.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(e){var t={data:{},nextCleanup:(new Date).getTime()+864e5};try{var a=localStorage.getItem(e);if(a&&(t=JSON.parse(a),(new Date).getTime()>t.nextCleanup))return localStorage.removeItem(e),{data:{},nextCleanup:(new Date).getTime()+864e5}}catch(n){console.error(n.message)}return t},A=function(e,t,a){var n=P(e);n.data[t]=a;try{localStorage.setItem(e,JSON.stringify(n))}catch(r){console.error(r.message),localStorage.removeItem(e)}},z="en";x.initialize(),x.getContext((function(e){var t=P("SUPPORTEDCULTURE_CACHE"),a=P("DEFAULTCULTURE_CACHE");t.data.SupportedCultures&&a.data.DefaultCulture?t.data.SupportedCultures.includes(e.locale.split("-")[0])||t.data.SupportedCultures.includes(e.locale)?S.a.changeLanguage(e.locale):S.a.changeLanguage(a.data.DefaultCulture):L().then((function(t){var a=t.data;A("SUPPORTEDCULTURE_CACHE","SupportedCultures",a),a.includes(e.locale.split("-")[0])||a.includes(e.locale)?S.a.changeLanguage(e.locale):N().then((function(e){z=e.data,A("DEFAULTCULTURE_CACHE","DefaultCulture",z),S.a.changeLanguage(z)}))}))})),S.a.use(w.a).use(k.e).init({lng:"en",fallbackLng:z,keySeparator:!1,interpolation:{escapeValue:!1},react:{useSuspense:!0}});var j,F,M=S.a,B=a(29),R=a.n(B),U=a(897);!function(e){e[e.None=0]="None",e[e.CloseRegistration=1]="CloseRegistration",e[e.CancelEvent=2]="CancelEvent",e[e.Register=3]="Register",e[e.Remove=4]="Remove"}(j||(j={})),function(e){e[e.None=0]="None",e[e.Draft=1]="Draft",e[e.Active=2]="Active",e[e.Cancelled=3]="Cancelled",e[e.Completed=4]="Completed"}(F||(F={}));var V,_,W=function(e){var t=O.a.defaults;return t.params=e,t},K=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/Event"),r=W({eventId:t,teamId:a}),e.next=4,T.get(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),G=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(I.apiBaseURL,"/users"),n=W({searchText:encodeURIComponent(t)}),e.next=4,T.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(I.apiBaseURL,"/group/get-group-members"),n=W({groupId:t}),e.next=4,T.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(h.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(I.apiBaseURL,"/users"),e.next=3,T.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=window.location.origin+"/api",Y=function(){var e=Object(h.a)(g.a.mark((function e(t,a,n,r,i,s){var o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(J,"/event/UserEvents"),(c=O.a.defaults).params={searchString:encodeURIComponent(t),pageCount:a,eventSearchType:n,createdByFilter:r,categoryFilter:i,sortBy:s},e.abrupt("return",T.get(o,c));case 4:case"end":return e.stop()}}),e)})));return function(t,a,n,r,i,s){return e.apply(this,arguments)}}(),q=function(e,t){var a="".concat(J,"/event/RegisterToEvent?teamId=").concat(e,"&eventId=").concat(t),n=O.a.defaults;return n.params={teamId:e,eventId:t},T.post(a,null,n)},Z=function(e,t){var a="".concat(J,"/event/UnregisterToEvent"),n=O.a.defaults;return n.params={teamId:e,eventId:t},T.post(a,null,n)},$=a(234),X=a(233),ee=a(235),te=a(88),ae=a(236),ne=a(121),re=a(921);!function(e){e[e.None=0]="None",e[e.Public=1]="Public",e[e.Private=2]="Private"}(V||(V={})),function(e){e[e.None=0]="None",e[e.InPerson=1]="InPerson",e[e.Teams=2]="Teams",e[e.LiveEvent=3]="LiveEvent"}(_||(_={}));var ie,se=a(23),oe=a(20),ce=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/eventfiles/upload-image"),r=W({teamId:a}),e.next=4,T.post(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),le=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/eventworkflow/create-draft"),r=W({teamId:a}),e.next=4,T.post(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ue=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/eventworkflow/update-draft"),r=W({teamId:a}),e.next=4,T.patch(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),de=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/eventworkflow/create-event"),r=W({teamId:a}),e.next=4,T.post(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),me=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/eventworkflow/update-event"),r=W({teamId:a}),e.next=4,T.patch(n,t,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),pe=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(I.apiBaseURL,"/category/get-categories-for-event"),e.next=3,T.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n,i,s,o,c,l,u,d,m,p,v,h,f,E,b,y,C,S,k,w,x,D,O;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o={mandatoryUsers:new Array,optionalUsers:new Array},c={mandatoryUsers:new Array,optionalUsers:new Array},l={mandatoryUsers:new Array,optionalUsers:new Array},u=0;case 4:if(!(u<t.length)){e.next=17;break}if(!(d=t[u]).isGroup){e.next=13;break}return e.next=9,H(d.id);case 9:(m=e.sent).status===r.OK&&(p=m.data.map((function(e){return e.id})),d.isMandatory?(v=c.mandatoryUsers).push.apply(v,Object(oe.a)(p)):(h=c.optionalUsers).push.apply(h,Object(oe.a)(p))),e.next=14;break;case 13:d.isMandatory?o.mandatoryUsers.push(d.id):o.optionalUsers.push(d.id);case 14:u++,e.next=4;break;case 17:for(o.mandatoryUsers=Object(oe.a)(new Set(o.mandatoryUsers)),o.optionalUsers=Object(oe.a)(new Set(o.optionalUsers)),c.mandatoryUsers=Object(oe.a)(new Set(c.mandatoryUsers)),c.optionalUsers=Object(oe.a)(new Set(c.optionalUsers)),f=new Array,E=function(e){o.mandatoryUsers.find((function(t){return t===o.optionalUsers[e]}))||f.push(o.optionalUsers[e])},b=0;b<o.optionalUsers.length;b++)E(b);for(o.optionalUsers=f,y=new Array,C=function(e){c.mandatoryUsers.find((function(t){return t===c.optionalUsers[e]}))||y.push(c.optionalUsers[e])},S=0;S<c.optionalUsers.length;S++)C(S);for(c.optionalUsers=y,k=new Array,w=function(e){o.optionalUsers.find((function(t){return t===c.mandatoryUsers[e]}))||k.push(c.mandatoryUsers[e])},x=0;x<c.mandatoryUsers.length;x++)w(x);for(c.mandatoryUsers=k,y=new Array,D=function(e){o.mandatoryUsers.find((function(t){return t===c.optionalUsers[e]}))||y.push(c.optionalUsers[e])},O=0;O<c.optionalUsers.length;O++)D(O);return c.optionalUsers=y,(a=l.mandatoryUsers).push.apply(a,Object(oe.a)(o.mandatoryUsers)),(n=l.mandatoryUsers).push.apply(n,Object(oe.a)(c.mandatoryUsers)),(i=l.optionalUsers).push.apply(i,Object(oe.a)(o.optionalUsers)),(s=l.optionalUsers).push.apply(s,Object(oe.a)(c.optionalUsers)),l.mandatoryUsers=Object(oe.a)(new Set(l.mandatoryUsers)),l.optionalUsers=Object(oe.a)(new Set(l.optionalUsers)),e.abrupt("return",{mandatoryUsers:l.mandatoryUsers,optionalUsers:l.optionalUsers});case 44:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,i,s,o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=Object(se.a)({},t.eventDetails)).startDate=R()(c.startDate).startOf("day").add(null===(n=c.startTime)||void 0===n?void 0:n.getHours(),"hours").add(null===(i=c.startTime)||void 0===i?void 0:i.getMinutes(),"minutes").utc().toDate(),c.endDate=R()(c.endDate).startOf("day").add(null===(s=c.startTime)||void 0===s?void 0:s.getHours(),"hours").add(null===(o=c.startTime)||void 0===o?void 0:o.getMinutes(),"minutes").utc().toDate(),c.startTime=R()(c.startTime).utc().toDate(),c.endTime=R()(c.endTime).utc().toDate(),c.selectedUserOrGroupListJSON=JSON.stringify(t.selectedUserGroups),e.next=8,de(c,a);case 8:if(e.sent.status!==r.OK){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),he=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Object(se.a)({},t.eventDetails)).startDate=R()(n.startDate).utc().toDate(),n.endDate=R()(n.endDate).utc().toDate(),n.startTime=R()(n.startTime).utc().toDate(),n.endTime=R()(n.endTime).utc().toDate(),n.selectedUserOrGroupListJSON=JSON.stringify(t.selectedUserGroups),e.next=8,me(n,a);case 8:if(e.sent.status!==r.OK){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),fe=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.eventDetails).startDate=R()(n.startDate).utc().toDate(),n.endDate=R()(n.endDate).utc().toDate(),n.startTime=R()(n.startTime).utc().toDate(),n.endTime=R()(n.endTime).utc().toDate(),n.selectedUserOrGroupListJSON=JSON.stringify(t.selectedUserGroups),!t.isDraft){e.next=15;break}return e.next=9,ue(n,a);case 9:if(e.sent.status!==r.OK){e.next=12;break}return e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 15:return e.next=17,le(n,a);case 17:if(e.sent.status!==r.OK){e.next=20;break}return e.abrupt("return",!0);case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ee=function(e,t,a){var n=R.a.utc(e).local().format("ddd"),r=R.a.utc(t).local().format("HH:mm"),i=R.a.utc(a).local().format("HH:mm");return"".concat(n,", ").concat(r," - ").concat(i)},be=a(16);function ye(e){return function(t){Object(d.a)(n,t);var a=Object(m.a)(n);function n(e){var t;return Object(l.a)(this,n),(t=a.call(this,e)).state={teamsContext:null,microsoftTeams:x,dir:ie.Ltr},t}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;x.initialize(),x.getContext((function(t){e.setState({teamsContext:t,dir:S.a.dir(t.locale)===ie.Rtl?ie.Rtl:ie.Ltr})}))}},{key:"render",value:function(){return s.a.createElement(e,Object.assign({},this.props,{teamsContext:this.state.teamsContext,microsoftTeams:this.state.microsoftTeams,dir:this.state.dir}))}}]),n}(i.Component)}!function(e){e.Rtl="rtl",e.Ltr="ltr",e.Auto="auto"}(ie||(ie={}));var Ce,Se,ke=Object(U.a)()(ye((function(e){var t=e.t;return i.createElement(E.a,{circular:!0,className:e.dir===ie.Rtl?"event-artifact rtl-right-margin-small":"event-artifact",title:e.audienceType===V.Private?t("private"):t("public"),content:i.createElement(X.a,{className:"text-overflow-ellipsis",gap:".6rem",start:e.audienceType===V.Private?i.createElement(be.EyeSlashIcon,null):i.createElement(be.EyeIcon,null),main:i.createElement(b.a,{className:"text-overflow-ellipsis",content:e.audienceType===V.Private?t("private"):t("public"),size:"small",weight:"semibold"})})})}))),we=Object(U.a)()((function(e){var t=e.t;return i.createElement(E.a,{circular:!0,className:"event-artifact",title:t("teamsMeeting"),content:i.createElement(X.a,{className:"text-overflow-ellipsis",gap:".6rem",start:i.createElement(be.TeamsIcon,null),main:i.createElement(b.a,{className:"text-overflow-ellipsis",content:t("teamsMeeting"),size:"small",weight:"semibold"})})})})),xe=Object(U.a)()((function(e){var t=e.t;return i.createElement(E.a,{circular:!0,className:"event-artifact",title:t("liveEvent"),content:i.createElement(X.a,{className:"text-overflow-ellipsis",gap:".6rem",start:i.createElement(be.BroadcastIcon,null),main:i.createElement(b.a,{className:"text-overflow-ellipsis",content:t("liveEvent"),size:"small",weight:"semibold"})})})})),De=Object(U.a)()((function(e){var t=e.t;return i.createElement(E.a,{circular:!0,className:"event-artifact mandatory text-overflow-ellipsis",title:t("mandatoryArtifactText"),content:i.createElement(X.a,{className:"text-overflow-ellipsis",start:i.createElement(be.RedbangIcon,null),main:i.createElement(b.a,{className:"text-overflow-ellipsis",content:t("mandatoryArtifactText"),size:"small",weight:"semibold"})})})})),Oe=a(28),Te=(a(829),Object(U.a)()((function(e){var t=e.t,a=i.useState(!1),n=Object(Oe.a)(a,2),r=n[0],s=n[1],o=i.useState(!1),c=Object(Oe.a)(o,2),l=c[0],u=c[1],d=function(){u(!0)};return i.createElement(i.Fragment,null,i.createElement("img",{className:"".concat(e.className," ").concat(r&&!l?"event-image-renderer image-loaded":"event-image-renderer image-not-loaded"),src:e.imageSrc,onLoad:function(){s(!0)},onError:d,onAbort:d}),r||l?l?i.createElement(f.a,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.a,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(be.ImageUnavailableIcon,{className:"placeholder-icon"}),i.createElement(b.a,{content:t("eventCardImageNotFoundPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))):void 0:i.createElement(f.a,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.a,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(b.a,{content:t("eventCardImageLoadingPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))))}))),Ie=a(919),Ne=(a(830),Object(U.a)()((function(e){var t=e.t,a=function(){var t,a,n,r=[];switch((null===(t=e.eventDetails)||void 0===t?void 0:t.isMandatoryForLoggedInUser)&&r.push(i.createElement(De,null)),null===(a=e.eventDetails)||void 0===a?void 0:a.type){case _.Teams:r.push(i.createElement(we,null));break;case _.LiveEvent:r.push(i.createElement(xe,null))}switch(null===(n=e.eventDetails)||void 0===n?void 0:n.audience){case V.Private:r.push(i.createElement(ke,{audienceType:V.Private}));break;case V.Public:r.push(i.createElement(ke,{audienceType:V.Public}))}return i.createElement(f.a,{gap:"gap.small",vAlign:"center"},r)},n=function(){switch(e.eventOperationType){case j.CloseRegistration:return t("closeRegistration");case j.CancelEvent:return t("cancelEvent");case j.Register:return t("register");case j.Remove:return t("remove")}};return function(){var r,s,o,c,l,u,d,m;return e.isLoadingEventDetails?i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"task-module-container"},i.createElement(ne.a,{className:"task-module-loader"})))):e.isFailedToGetEventDetails||!e.eventDetails?i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"task-module-container event-task-module"},i.createElement(b.a,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"})))):i.createElement(Ie.a,{dir:e.dir},i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"".concat(e.isMobileView?"mobile-task-module-container":"task-module-container"," event-task-module")},i.createElement("div",{className:"event-info"},function(){var t,n,r,s;return e.isMobileView?i.createElement(f.a,{column:!0,vAlign:"center",gap:"gap.smaller"},i.createElement(b.a,{className:"category label-color",truncated:!0,content:null===(t=e.eventDetails)||void 0===t?void 0:t.categoryName,title:null===(n=e.eventDetails)||void 0===n?void 0:n.categoryName,weight:"bold"}),i.createElement(f.a,{vAlign:"center"},a())):i.createElement(f.a,{space:"between",vAlign:"center"},i.createElement(b.a,{className:"category label-color",truncated:!0,content:null===(r=e.eventDetails)||void 0===r?void 0:r.categoryName,title:null===(s=e.eventDetails)||void 0===s?void 0:s.categoryName,weight:"bold"}),i.createElement(f.a.Item,{push:e.dir===ie.Ltr},a()))}(),e.eventDetails.photo&&i.createElement(Te,{className:"event-image",imageSrc:e.eventDetails.photo}),e.eventDetails.selectedColor&&i.createElement("div",{className:"event-image",style:{backgroundColor:e.eventDetails.selectedColor}},i.createElement(f.a,{className:"event-image",hAlign:"center",vAlign:"center"},i.createElement(b.a,{className:"event-color-text",size:"large",weight:"semibold",content:e.eventDetails.name,title:e.eventDetails.name}))),i.createElement("div",{style:{marginTop:"1.33rem"}},i.createElement(b.a,{align:e.dir===ie.Rtl?"end":"start",className:e.dir===ie.Rtl?"rtl-right-margin-smaller":"",content:null===(r=e.eventDetails)||void 0===r?void 0:r.name,weight:"bold",size:"medium"})),i.createElement(f.a,{vAlign:"center",hAlign:"start"},i.createElement(X.a,{className:"event-date-and-time",start:i.createElement(re.a,{iconName:"Clock"}),main:i.createElement(b.a,{content:Ee(null===(s=e.eventDetails)||void 0===s?void 0:s.startDate,null===(o=e.eventDetails)||void 0===o?void 0:o.startTime,e.eventDetails.endTime),weight:"semibold",size:"small"}),gap:".4rem"}),function(e,t){if(e===_.InPerson)return i.createElement(i.Fragment,null,i.createElement(ee.a,{vertical:!0,styles:{height:"1.13rem",marginRight:".8rem"}}),i.createElement(b.a,{className:"event-venue",content:t,weight:"semibold",size:"small"}))}(null===(c=e.eventDetails)||void 0===c?void 0:c.type,null===(l=e.eventDetails)||void 0===l?void 0:l.venue)),i.createElement(f.a,{vAlign:"center",hAlign:"start",design:{marginTop:"2.67rem"}},i.createElement(b.a,{className:e.dir===ie.Rtl?"rtl-right-margin-small":"",content:null===(u=e.eventDetails)||void 0===u?void 0:u.description})),function(){var a,n,r;if((null===(a=e.eventDetails)||void 0===a?void 0:a.type)===_.LiveEvent)return i.createElement(f.a,{design:{marginTop:"2.67rem"},vAlign:"center",hAlign:"start",column:!0},i.createElement(b.a,{content:t("liveEventUrlStep1"),weight:"semibold"}),i.createElement("a",{href:null===(n=e.eventDetails)||void 0===n?void 0:n.meetingLink,target:"_blank",rel:"noopener noreferrer"},null===(r=e.eventDetails)||void 0===r?void 0:r.meetingLink))}(),i.createElement(f.a,{gap:e.dir===ie.Rtl?void 0:"gap.large",className:e.dir===ie.Rtl?"rtl-right-margin-small":"",design:{marginTop:"2.67rem"}},i.createElement(f.a,{column:!0,className:e.dir===ie.Rtl?"rtl-left-margin-large":""},i.createElement(b.a,{content:t("totalNoOfParticipants"),weight:"semibold"}),i.createElement(b.a,{align:e.dir===ie.Rtl?"end":"start",content:null===(d=e.eventDetails)||void 0===d?void 0:d.maximumNumberOfParticipants})),i.createElement(f.a,{column:!0},i.createElement(b.a,{content:t("registeredParticipants"),weight:"semibold"}),i.createElement(b.a,{align:e.dir===ie.Rtl?"end":"start",content:null===(m=e.eventDetails)||void 0===m?void 0:m.registeredAttendeesCount}))),function(){var a=e.eventCreatedByName&&e.eventCreatedByName.length?e.eventCreatedByName:t("unknownUserName");return i.createElement(f.a,{vAlign:"center",hAlign:"start",gap:"gap.smaller",design:{marginTop:"2.67rem"}},i.createElement($.a,{size:"small",name:a,className:e.dir===ie.Rtl?"rtl-left-margin-small":""}),i.createElement(X.a,{start:i.createElement(b.a,{content:t("createdBy"),size:"small"}),main:i.createElement(b.a,{content:a,size:"small",weight:"semibold"}),gap:".4rem"}))}()),function(){if(e.eventOperationType!==j.None)return i.createElement(f.a,{className:"footer",vAlign:"center"},e.isOperationFailed?i.createElement(b.a,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):null,i.createElement(f.a.Item,{grow:e.dir===ie.Rtl,push:e.dir===ie.Ltr},i.createElement("div",null,i.createElement(te.a,{primary:!0,loading:e.isOperationInProgress,disabled:e.isOperationInProgress,content:n(),onClick:e.onPerformOperation}))))}()))))}()}))),Le=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.isMobileView=void 0,n.getEventDetailsAsync=Object(h.a)(g.a.mark((function e(){var t,a,i,s,o,c,l,u;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new URLSearchParams(window.location.search),s=null!==(t=i.get("eventId"))&&void 0!==t?t:"0",o=null!==(a=i.get("teamId"))&&void 0!==a?a:"0",n.isMobileView="true"===i.get("isMobileView"),e.next=6,K(s,o);case 6:(c=e.sent).status===r.OK&&c.data?(l=c.data,u=j.None,l.status===F.Active&&new Date<R.a.utc(l.endDate).local().toDate()&&(l.isLoggedInUserRegistered?u=j.Remove:!l.isRegistrationClosed&&l.registeredAttendeesCount<l.maximumNumberOfParticipants&&l.canLoggedInUserRegister&&(u=j.Register)),n.setState({isLoading:!1,eventDetails:l,eventOperationType:u},(function(){n.state.eventDetails&&n.getUserProfileAsync(n.state.eventDetails.createdBy)}))):n.setState({isLoading:!1,isErrorGettingEventDetails:!0});case 8:case"end":return e.stop()}}),e)}))),n.getUserProfileAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[t],e.next=3,Q(a);case 3:(i=e.sent).status===r.OK&&i.data&&(s=i.data[0],n.setState({eventCreatedBy:s.displayName}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onRegisterRemoveEvent=Object(h.a)(g.a.mark((function e(){var t,a,i,s,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.state.eventDetails?n.state.eventDetails.teamId:"0",o=n.state.eventDetails?n.state.eventDetails.eventId:"0",e.t0=n.state.eventOperationType,e.next=e.t0===j.Register?5:e.t0===j.Remove?12:19;break;case 5:return n.setState({isLoading:!0}),e.next=8,q(s,o);case 8:return t=e.sent,a=t.status===r.OK,i=!0===t.data,e.abrupt("break",20);case 12:return n.setState({isLoading:!0}),e.next=15,Z(s,o);case 15:return t=e.sent,a=t.status===r.OK,i=!0===t.data,e.abrupt("break",20);case 19:return e.abrupt("break",20);case 20:t&&a&&i?(x.tasks.submitTask({isSuccess:!0,type:n.state.eventOperationType}),n.setState({isFailedToRegisterOrRemove:!1,isOperationInProgress:!0}),n.setState({isLoading:!1})):(n.setState({isFailedToRegisterOrRemove:!0,isOperationInProgress:!1}),n.setState({isLoading:!1}));case 21:case"end":return e.stop()}}),e)}))),n.localize=n.props.t,n.isMobileView=!1,n.state={isLoading:!0,isOperationInProgress:!1,eventDetails:void 0,eventCreatedBy:"",isErrorGettingEventDetails:!1,isFailedToRegisterOrRemove:!1,eventOperationType:j.None},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){x.initialize(),this.getEventDetailsAsync()}},{key:"render",value:function(){return i.createElement(Ne,{dir:this.props.dir,eventDetails:this.state.eventDetails,eventCreatedByName:this.state.eventCreatedBy,eventOperationType:this.state.eventOperationType,isLoadingEventDetails:this.state.isLoading,isFailedToGetEventDetails:this.state.isErrorGettingEventDetails,isOperationInProgress:this.state.isOperationInProgress,isOperationFailed:this.state.isFailedToRegisterOrRemove,isMobileView:this.isMobileView,onPerformOperation:this.onRegisterRemoveEvent})}}]),a}(i.Component),Pe=Object(U.a)()(ye(Le)),Ae=a(182),ze=a(177);!function(e){e[e.AllPublicPrivateEventsForUser=0]="AllPublicPrivateEventsForUser",e[e.MandatoryEventsForUser=1]="MandatoryEventsForUser",e[e.DraftEventsForTeam=2]="DraftEventsForTeam",e[e.ActiveEventsForTeam=3]="ActiveEventsForTeam",e[e.CompletedEventsForTeam=4]="CompletedEventsForTeam",e[e.RegisteredEventsForUser=5]="RegisteredEventsForUser",e[e.CompletedEventsForUser=7]="CompletedEventsForUser"}(Ce||(Ce={})),function(e){e[e.Recent=0]="Recent",e[e.Popularity=1]="Popularity"}(Se||(Se={}));var je=a(904),Fe=a(905),Me=a(906),Be=a(210),Re=a.n(Be),Ue=(a(833),Object(U.a)()((function(e){var t=e.t,a=i.useState(!1),n=Object(Oe.a)(a,2),r=n[0],s=n[1],o=i.useState(!1),c=Object(Oe.a)(o,2),l=c[0],u=c[1],d=function(){u(!0)};return i.createElement(i.Fragment,null,i.createElement("img",{className:"".concat(e.className," ").concat(r&&!l?"event-image-renderer image-loaded":"event-image-renderer image-not-loaded"),src:e.imageSrc,onLoad:function(){s(!0)},onError:d,onAbort:d}),r||l?l?i.createElement(f.a,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.a,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(be.ImageUnavailableIcon,{className:"placeholder-icon"}),i.createElement(b.a,{content:t("eventCardImageNotFoundPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))):void 0:i.createElement(f.a,{className:"".concat(e.className," event-image-placeholder-container"),vAlign:"center",hAlign:"center"},i.createElement(f.a,{className:"event-image-placeholder",vAlign:"center",hAlign:"center",gap:"gap.small",fill:!0},i.createElement(b.a,{content:t("eventCardImageLoadingPlaceholder"),align:"center",size:"medium",weight:"semibold",color:"white"}))))}))),Ve=(a(834),Object(U.a)()(ye((function(e){var t=e.t;return i.createElement(f.a,{column:!0,className:"event-card",onClick:e.onClick},e.eventDetails.photo&&i.createElement(Ue,{className:"event-photo",imageSrc:e.eventDetails.photo}),e.eventDetails.selectedColor&&i.createElement("div",{className:"event-photo",style:{backgroundColor:e.eventDetails.selectedColor}},i.createElement(f.a,{className:"event-photo",hAlign:"center",vAlign:"center"},i.createElement(b.a,{className:"event-color-text",size:"medium",weight:"semibold",title:e.eventDetails.name,content:e.eventDetails.name}))),i.createElement(f.a,{className:"event-info",column:!0,fill:!0},i.createElement(f.a,{vAlign:"center",gap:"gap.medium"},i.createElement(f.a,{className:"event-day",column:!0,vAlign:"center",hAlign:"center",fill:!0},i.createElement(b.a,{content:R.a.utc(e.eventDetails.startDate).local().format("DD"),size:"large",weight:"bold"}),i.createElement(b.a,{content:R.a.utc(e.eventDetails.startDate).local().format("MMM"),size:"medium",weight:"semibold"})),i.createElement(f.a,{className:"event-details",column:!0,vAlign:"center",fill:!0},i.createElement(b.a,{align:"rtl"===e.dir?"end":void 0,className:"rtl"===e.dir?"event-category rtl-right-margin-small":"event-category",truncated:!0,content:e.eventDetails.categoryName,weight:"bold",size:"smaller"}),i.createElement(b.a,{align:"rtl"===e.dir?"end":void 0,className:"rtl"===e.dir?"rtl-right-margin-small":"",truncated:!0,content:e.eventDetails.name,title:e.eventDetails.name,weight:"bold",size:"medium"}),i.createElement(f.a,{className:"rtl"===e.dir?"event-date-and-venue-rtl event-date-and-venue":"event-date-and-venue",vAlign:"center"},i.createElement(re.a,{iconName:"Clock"}),i.createElement(f.a.Item,{shrink:!1},i.createElement(b.a,{weight:"semibold",size:"small",content:Ee(e.eventDetails.startDate,e.eventDetails.startTime,e.eventDetails.endTime)})),function(){if(e.eventDetails.type===_.InPerson)return i.createElement(i.Fragment,null,i.createElement(ee.a,{className:"event-date-venue-separator",vertical:!0}),i.createElement(b.a,{truncated:!0,className:"event-venue",content:e.eventDetails.venue,title:e.eventDetails.venue,weight:"semibold",size:"small"}))}()))),i.createElement(f.a,{className:"event-participants",gap:"gap.small"},i.createElement(b.a,{size:"small",content:"".concat(t("participantsRegistered")," : ").concat(e.eventDetails.registeredAttendeesCount)}),i.createElement(ee.a,{vertical:!0}),i.createElement(b.a,{size:"small",content:"".concat(t("availableSlots")," : ").concat(e.eventDetails.registeredAttendeesCount<e.eventDetails.maximumNumberOfParticipants?e.eventDetails.maximumNumberOfParticipants-e.eventDetails.registeredAttendeesCount:0)})),function(){var t=[];switch(e.eventDetails.isMandatoryForLoggedInUser&&t.push(i.createElement(De,null)),e.eventDetails.type){case _.Teams:t.push(i.createElement(we,null));break;case _.LiveEvent:t.push(i.createElement(xe,null))}switch(e.eventDetails.audience){case V.Private:t.push(i.createElement(ke,{audienceType:V.Private}));break;case V.Public:t.push(i.createElement(ke,{audienceType:V.Public}))}return i.createElement(f.a,{className:"footer",gap:"gap.small",vAlign:"center"},t)}()))})))),_e=(a(835),a(836),function(e){return i.createElement("div",{className:"user-events"},i.createElement("div",{className:"container-subdiv-cardview"},i.createElement(Me.a,{key:e.key,className:"pagination-scroll-area",fluid:!0},i.createElement(Re.a,{pageStart:0,initialLoad:!1,loader:i.createElement(ne.a,null),useWindow:!1,loadMore:e.loadMoreEvents,hasMore:e.hasMoreEvents},function(){if(!e.events||0===e.events.length)return"No events available";var t=e.events.map((function(t,a){return i.createElement(je.a,{className:"grid-column d-flex justify-content-center",xl:4,lg:4,sm:6,md:4},i.createElement(Ve,{key:"event-".concat(a),eventDetails:t,onClick:function(){return e.onClick(t)}}))}));return i.createElement(Fe.a,{"data-testid":"event_count"},t)}()))))}),We=a(427),Ke=function(e){return i.createElement("div",{className:"no-content-container"},i.createElement("div",{className:"app-logo"},i.createElement(We.a,{size:"largest"})),i.createElement("div",{className:"no-content-title"},i.createElement(b.a,{content:e.message,weight:"semibold"})))},Ge=a(334),He=a(189),Qe=a(120),Je=a(440),Ye=a(172),qe=a(433),Ze=a(463),$e=(a(325),i.memo((function(e){var t=Object(Ze.a)().t,a=i.useState({checkboxes:e.content.checkboxes}),n=Object(Oe.a)(a,2),r=n[0],s=(n[1],i.useState(e.content.checkboxes)),o=Object(Oe.a)(s,2),c=o[0],l=o[1],u=i.useState(""),d=Object(Oe.a)(u,2),m=d[0],p=d[1],v=i.useState(!0),g=Object(Oe.a)(v,2),h=g[0],E=g[1],b=i.useState(!1),y=Object(Oe.a)(b,2),C=y[0],S=y[1];i.useEffect((function(){w(e.content.checkboxes)}),[]);var k=function(t,a){var n=0;S(!0);var i=r.checkboxes.map((function(e){return e.key===t&&(e.isChecked=a),e}));if(i.map((function(e){e.isChecked&&(n+=1)})),E(!(n>0)),m.trim().length){var s=i.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}));w(s)}else w(i);e.onCheckboxStateChange(i)},w=function(e){if(e&&e.length>0){var t=Object(oe.a)(e).slice(0,50);l(t)}else l([])};return i.createElement(Ie.a,{dir:e.dir},i.createElement(ae.a,null,i.createElement("div",{className:"content-items-wrapper"},e.showSearchBar&&i.createElement("div",{className:"content-items-headerfooter"},i.createElement(ze.a,{icon:i.createElement(qe.a,null),iconPosition:"rtl"===e.dir?"start":"end",placeholder:t("searchPlaceholder"),value:m,fluid:!0,onChange:function(e){return function(e){if(p(e),e.trim().length>0){var t=r.checkboxes.filter((function(t){return t.title.toLowerCase().includes(e.toLowerCase())}));w(t)}else w(r.checkboxes)}(e.target.value)}})),i.createElement(ee.a,{className:"filter-popup-menu-divider"}),i.createElement("div",{className:"content-items-headerfooter"},i.createElement(f.a,{gap:"gap.small",vAlign:"center",hAlign:"end"},i.createElement(f.a.Item,{push:!0},i.createElement("div",null)),i.createElement(te.a,{disabled:C?h:e.disableClear,className:0===e.selectedCount?"clear-button ":"clear-button enable-clear",size:"small",text:!0,onClick:function(){return function(){var t=r.checkboxes.map((function(e){return e.isChecked=!1,e})),a=t;m.trim().length&&(a=t.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}))),w(a),e.onCheckboxStateChange(t),E(!0),S(!0)}()},content:e.selectedCount>0?t("clear")+"("+e.selectedCount.toString()+")":t("clear")}))),i.createElement("div",{className:"content-items-body"},c.map((function(e){if(e.title.trim().length)return i.createElement(f.a,{gap:"gap.small"},i.createElement(Ye.a,{"data-testid":e.key+"_categoryCheckbox_item",className:"checkbox-wrapper",label:e.checkboxLabel,key:e.key,checked:e.isChecked,onChange:function(t,a){return k(e.key,a.checked)}}))}))))))}))),Xe=a(237),et=i.memo((function(e){return i.createElement(Ie.a,{dir:e.dir},i.createElement("div",{className:"content-items-wrapper radio-popup-content"},i.createElement("div",{className:"content-items-body"},i.createElement(f.a,{gap:"gap.small"},i.createElement(Xe.a,{defaultCheckedValue:e.selectedValue,vertical:!0,items:e.content.radioGroupItems,onCheckedValueChange:function(t,a){return e.onRadiogroupStateChange(a.value)},"data-testid":"radioGroup_items"})))))})),tt=i.memo((function(e){var t=i.useState({isOpen:!1}),a=Object(Oe.a)(t,2),n=a[0],r=a[1],s=i.useState(!0),o=Object(Oe.a)(s,2),c=o[0],l=o[1],u=function(t){r({isOpen:t}),e.onOpenChange(t)};return e.checkboxes?i.createElement(Qe.a,{className:"popup-container",open:n.isOpen,align:"end",position:"below",onOpenChange:function(e,t){var a=t.open;return u(a)},trigger:i.createElement(te.a,{"data-testid":e.checkboxes.length>0?e.checkboxes[0].title+"_CheckboxButton":"dummyTitle_CheckboxButton",className:"filter-button",onClick:function(){return function(){var t=0;e.checkboxes.map((function(e){e.isChecked&&(t+=1)})),l(!(t>0))}()},content:i.createElement(b.a,{content:e.title,className:e.dir===ie.Rtl?"rtl-left-margin-small":""}),iconPosition:"after",icon:i.createElement(Je.a,null),text:!0}),content:i.createElement($e,{dir:e.dir,disableClear:c,selectedCount:e.selectedCount,showSearchBar:e.showSearchBar,content:{checkboxes:e.checkboxes,title:e.title},onCheckboxStateChange:e.onCheckboxStateChange}),trapFocus:!0}):e.radioGroup?i.createElement(Qe.a,{open:n.isOpen,align:"end",position:"below",onOpenChange:function(e,t){var a=t.open;return u(a)},trigger:i.createElement(te.a,{"data-testid":e.radioGroup.length>0?e.radioGroup[0].name+"_RadioGroupButton":"dummyName_RadioGroupButton",icon:i.createElement(Je.a,null),className:"filter-button",iconPosition:"after",content:i.createElement(b.a,{content:e.title,className:e.dir===ie.Rtl?"rtl-left-margin-small":""}),text:!0}),content:i.createElement(et,{dir:e.dir,selectedValue:e.selectedSortBy,content:{radioGroupItems:e.radioGroup,title:e.title},onRadiogroupStateChange:e.onRadiogroupStateChange}),trapFocus:!0}):i.createElement(i.Fragment,null)})),at=function e(){Object(l.a)(this,e)};at.dark="dark",at.contrast="contrast",at.eventNameMaxLength=100,at.eventDescriptionMaxLength=1e3,at.eventVenueMaxLength=200,at.userEventsMobileFilteredCategoriesLocalStorageKey="user-events-filtered-categories",at.userEventsMobileFilteredUsersLocalStorageKey="user-events-filtered-users",at.userEventsMobileSortByFilterLocalStorageKey="user-events-sortby",at.validUrlRegExp=/^http(s)?:\/\/(www\.)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/,at.colorCells=[{id:"a",label:"Wild blue yonder",color:"#A4A8CB"},{id:"b",label:"Jasmine",color:"#FFDE85"},{id:"c",label:"Sky blue",color:"#A0EAF8"},{id:"d",label:"Nadeshiko pink",color:"#F1A7B9"},{id:"e",label:"Lavender blue",color:"#E3D7FF"}],at.audienceType=[{name:"Public",id:V.Public},{name:"Private",id:V.Private}],at.sortBy=[{name:"Newest",id:Se.Recent,color:""},{name:"Popularity",id:Se.Popularity,color:""}],at.eventType=[{name:"In person",id:_.InPerson},{name:"Teams",id:_.Teams},{name:"Live event",id:_.LiveEvent}];var nt,rt=function(e){return at.sortBy.map((function(t){switch(t.id){case Se.Recent:return t.name=e("sortByNewest"),t;case Se.Popularity:return t.name=e("sortByPopularity"),t;default:return t}}))},it=(a(837),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.isFilterStateChanged=void 0,n.resize=function(){window.innerWidth!==n.state.screenWidth&&n.setState({screenWidth:window.innerWidth})},n.onCategoryStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.isFilterStateChanged=!0,n.setState({categoryList:e,categorySelectedCount:t?t.length:0})},n.onCreatedByStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.isFilterStateChanged=!0,n.setState({createdByList:e,createdBySelectedCount:t?t.length:0})},n.onSortByStateChange=function(e){n.isFilterStateChanged=!0,n.setState({selectedSortBy:e})},n.onCloseIconClick=function(e){n.props.onFilterBarCloseClick(n.state.categorySelectedCount>0||n.state.createdBySelectedCount>0||n.state.selectedSortBy!==Se.Recent),n.isFilterStateChanged=!1},n.onFilterChange=function(e){if(!e&&n.isFilterStateChanged){var t=n.state.categoryList?Object(oe.a)(n.state.categoryList):[],a=n.state.createdByList?Object(oe.a)(n.state.createdByList):[],r=t.filter((function(e){return e.isChecked})),i=a.filter((function(e){return e.isChecked})),s=r.map((function(e){return e.key})),o=i.map((function(e){return e.key}));n.isFilterStateChanged=!1,n.props.onFilterChange(s,o,n.state.selectedSortBy)}else n.isFilterStateChanged=!1},Object(He.a)(),n.localize=n.props.t,n.isFilterStateChanged=!1;var r=rt(n.localize).map((function(e){return{key:e.id,label:e.name,value:e.id,name:e.name}}));return n.state={selectedSortBy:r[0].value,categoryList:[],createdByList:[],sortBy:r,screenWidth:800,createdBySelectedCount:0,categorySelectedCount:0},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize.bind(this)),this.resize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"componentWillReceiveProps",value:function(e){if(e.isReset){var t=this.state.categoryList?Object(oe.a)(this.state.categoryList):[],a=this.state.createdByList?Object(oe.a)(this.state.createdByList):[];this.isFilterStateChanged=!1,this.setState({categoryList:t.map((function(e){return e.isChecked=!1,e})),categorySelectedCount:0,createdByList:a.map((function(e){return e.isChecked=!1,e})),createdBySelectedCount:0,selectedSortBy:Se.Recent})}e.categoryList&&e.categoryList!==this.props.categoryList&&this.setState({categoryList:e.categoryList.map((function(e){return{isChecked:!1,key:e.categoryId,title:e.name,checkboxLabel:i.createElement(b.a,{content:e.name})}}))}),e.createdByList&&e.createdByList!==this.props.createdByList&&this.setState({createdByList:e.createdByList.map((function(e){return{isChecked:!1,key:e.aadObjectId,title:e.name,checkboxLabel:i.createElement(b.a,{content:e.name})}}))})}},{key:"render",value:function(){return this.props.isVisible?i.createElement(Ie.a,{dir:this.props.dir},i.createElement(f.a,{className:"filter-bar","data-testid":"filterbar"},this.state.screenWidth>750&&i.createElement(f.a,{gap:"gap.small",vAlign:"center",className:"filter-bar-wrapper",space:"between"},i.createElement("div",{className:"filter-bar-item-container"},i.createElement(b.a,{content:this.localize("category"),weight:"semibold",className:"title-text"}),i.createElement(tt,{dir:this.props.dir,title:this.state.categorySelectedCount>0?this.state.categorySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.categorySelectedCount,checkboxes:this.state.categoryList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCategoryStateChange,onOpenChange:this.onFilterChange}),i.createElement(b.a,{content:this.localize("createdBy"),weight:"semibold",className:"title-text"}),i.createElement(tt,{dir:this.props.dir,title:this.state.createdBySelectedCount>0?this.state.createdBySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,checkboxes:this.state.createdByList,selectedCount:this.state.createdBySelectedCount,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange}),i.createElement(b.a,{content:this.localize("sortBy"),weight:"semibold",className:"title-text"}),i.createElement(tt,{dir:this.props.dir,title:this.state.sortBy[this.state.selectedSortBy].name,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.createdBySelectedCount,radioGroup:this.state.sortBy,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange})),i.createElement(f.a.Item,{push:this.props.dir===ie.Ltr},i.createElement(Ge.a,{onClick:this.onCloseIconClick,className:this.props.dir===ie.Rtl?"close-icon rtl-left-margin-small":"close-icon"}))),this.state.screenWidth<=750&&i.createElement(f.a,{gap:"gap.small",vAlign:"start",className:"filter-bar-wrapper"},i.createElement(f.a.Item,{grow:!0},i.createElement(f.a,{column:!0,gap:"gap.small",vAlign:"stretch"},i.createElement(f.a,{className:"mobile-filterbar-wrapper"},i.createElement(tt,{dir:this.props.dir,title:this.state.categorySelectedCount>0?this.state.categorySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.categorySelectedCount,checkboxes:this.state.categoryList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCategoryStateChange,onOpenChange:this.onFilterChange}),i.createElement(tt,{dir:this.props.dir,title:this.state.createdBySelectedCount>0?this.state.createdBySelectedCount+" "+this.localize("selected"):this.localize("selectHere"),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.createdBySelectedCount,checkboxes:this.state.createdByList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange}),i.createElement(tt,{dir:this.props.dir,title:this.state.sortBy[this.state.selectedSortBy].name,selectedCount:this.state.createdBySelectedCount,selectedSortBy:this.state.selectedSortBy,radioGroup:this.state.sortBy,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onOpenChange:this.onFilterChange}))))))):i.createElement(i.Fragment,null)}}]),a}(i.Component)),st=Object(U.a)()(ye(it)),ot=a(107),ct=(a(838),function(e){return i.createElement(f.a,{className:"tab-menu"},i.createElement(ot.a,{primary:!0,items:e.tabItems,defaultActiveIndex:e.defaultTabIndex,activeIndex:e.activeTabIndex,onActiveIndexChange:function(t,a){return e.onTabIndexChange(a)}}))});!function(e){e[e.None=0]="None",e[e.Success=1]="Success",e[e.Error=2]="Error"}(nt||(nt={}));var lt=a(914),ut=(a(839),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.onClose=function(){n.setState({isShowNotification:!1})},n.localize=n.props.t,n.state={isShowNotification:!1},n}return Object(u.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t;e.notification.id!==this.props.notification.id&&(null===(t=e.notification.message)||void 0===t?void 0:t.length)&&e.notification.type!==nt.None&&this.setState({isShowNotification:!0})}},{key:"render",value:function(){return i.createElement(lt.a,{className:"notification-toast ".concat(this.props.notification.type===nt.Success?"success":"error"),autohide:!0,delay:4e3,show:this.state.isShowNotification,onClose:this.onClose},i.createElement(lt.a.Body,{className:this.props.dir===ie.Ltr?"notification":"rtl-notification"},i.createElement("strong",null,this.props.notification.message)))}}]),a}(i.Component)),dt=Object(U.a)()(ut),mt=window.location.origin+"/api",pt=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(mt,"/LnDTeam"),e.next=3,T.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vt=function(){localStorage.removeItem(at.userEventsMobileFilteredCategoriesLocalStorageKey),localStorage.removeItem(at.userEventsMobileFilteredUsersLocalStorageKey),localStorage.removeItem(at.userEventsMobileSortByFilterLocalStorageKey)},gt=(a(840),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.searchText=void 0,n.timeout=void 0,n.mandatoryEventsCount=void 0,n.allEventsCount=void 0,n.screenResize=function(){n.setState({isMobileView:window.innerWidth<=I.maxWidthForMobileView})},n.loadEventCategories=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({categoriesInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.loadAllLnDTeamMembers=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({lnDTeamMembersInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.getEventsAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s,o,c=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>1&&void 0!==c[1]?c[1]:0,t!==Ce.MandatoryEventsForUser){e.next=7;break}return e.next=4,Y(n.state.searchText,i,Ce.MandatoryEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 4:s=e.sent,e.next=10;break;case 7:return e.next=9,Y(n.state.searchText,i,Ce.AllPublicPrivateEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 9:s=e.sent;case 10:return o=[],s&&s.status===r.OK&&(null===(a=s.data)||void 0===a?void 0:a.length)>0&&(o=s.data),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.loadEvents=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,r,i,s,o,c,l,u,d=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:0,e.next=3,n.getEventsAsync(t,a);case 3:if(!(r=e.sent)){e.next=15;break}e.t0=t,e.next=e.t0===Ce.MandatoryEventsForUser?8:e.t0===Ce.AllPublicPrivateEventsForUser?10:12;break;case 8:return a>0?(i=Object(oe.a)(r),s=Object(oe.a)(n.state.mandatoryEvents),o=i.filter((function(e){return-1===s.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({mandatoryEvents:s.concat(o),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})):(n.setTotalEventsCount(Ce.MandatoryEventsForUser,r.length),n.setState({mandatoryEvents:Object(oe.a)(r),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})),e.abrupt("break",13);case 10:return a>0?(c=Object(oe.a)(r),l=Object(oe.a)(n.state.allEvents),u=c.filter((function(e){return-1===l.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({allEvents:l.concat(u),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})):(n.setTotalEventsCount(Ce.AllPublicPrivateEventsForUser,r.length),n.setState({allEvents:Object(oe.a)(r),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})),e.abrupt("break",13);case 12:return e.abrupt("break",13);case 13:e.next=16;break;case 15:0===a?(n.setTotalEventsCount(t,0),t===Ce.MandatoryEventsForUser?n.setState({mandatoryEvents:[],hasMoreEvents:!1}):n.setState({allEvents:[],hasMoreEvents:!1})):n.setState({hasMoreEvents:!1});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setTotalEventsCount=function(e,t){var a,r;if((!n.state.searchText||""===n.state.searchText.trim())&&!(null===(a=n.state.filteredCategories)||void 0===a?void 0:a.length)&&!(null===(r=n.state.filteredUsers)||void 0===r?void 0:r.length))switch(e){case Ce.MandatoryEventsForUser:n.mandatoryEventsCount=t;break;case Ce.AllPublicPrivateEventsForUser:n.allEventsCount=t}},n.onEventClick=function(e){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/register-remove?eventId=").concat(e.eventId,"&teamId=").concat(e.teamId,"&isMobileView=").concat(n.state.isMobileView),height:746,width:600,title:n.localize("eventDetailsStep1")},(function(t,a){if(a){var r=0===n.state.activeTabIndex?Object(oe.a)(n.state.mandatoryEvents):Object(oe.a)(n.state.allEvents),i=null===r||void 0===r?void 0:r.findIndex((function(t){return t.eventId===e.eventId})),s=r[i];s.registeredAttendeesCount=a.type===j.Register?s.registeredAttendeesCount+1:s.registeredAttendeesCount-1,0===n.state.activeTabIndex?n.setState((function(e){return{mandatoryEvents:r,notification:{id:e.notification.id+1,message:a.type===j.Register?n.localize("eventRegistrationSuccessfulMessage"):n.localize("eventUnregistrationSuccessfulMessage"),type:nt.Success}}})):n.setState((function(e){return{allEvents:r,notification:{id:e.notification.id+1,message:a.type===j.Register?n.localize("eventRegistrationSuccessfulMessage"):n.localize("eventUnregistrationSuccessfulMessage"),type:nt.Success}}}))}}))},n.onTabIndexChange=function(e){n.timeout&&window.clearTimeout(n.timeout),vt(),n.setState({isLoadingEvents:!0,activeTabIndex:null===e||void 0===e?void 0:e.activeIndex,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:Se.Recent,isResetFilter:!0},(function(){n.timeout=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&n.getEvents();case 1:case"end":return t.stop()}}),t)}))),700)}))},n.onSearchEvents=function(e){13===e.keyCode&&""!==n.state.searchText.trim()&&n.getEvents()},n.onSearchTextChange=function(e){e.target.value.length?n.setState({searchText:e.target.value}):n.setState({searchText:""},(function(){n.getEvents()}))},n.onFilterBarToggle=function(){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,isResetFilter:!1}}))},n.onMobileFilterButtonClick=function(){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/mobile-filter"),height:746,width:600,title:n.localize("mobileFilterTitle")},(function(e,t){if(t&&t.isFilterStateChanged){var a=localStorage.getItem(at.userEventsMobileFilteredCategoriesLocalStorageKey),r=localStorage.getItem(at.userEventsMobileFilteredUsersLocalStorageKey),i=localStorage.getItem(at.userEventsMobileSortByFilterLocalStorageKey);n.setState({filteredCategories:a||"",filteredUsers:r||"",sortByFilter:i||0},(function(){return n.getEvents()}))}}))},n.onFilterBarClose=function(e){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,filteredCategories:"",filteredUsers:"",sortByFilter:Se.Recent,isResetFilter:!0}}),(function(){e&&n.getEvents()}))},n.onFilterChange=function(e,t,a){var r=e||[],i=t||[];n.setState({filteredCategories:r.join(";"),filteredUsers:i.join(";"),sortByFilter:a},(function(){n.getEvents()}))},n.onMobileSearchBoxClose=function(){var e;n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen}),(null===(e=n.state.searchText)||void 0===e?void 0:e.trim().length)&&n.setState({searchText:""},(function(){return n.getEvents()}))},n.getEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(0===e&&n.setState((function(e){return{isLoadingEvents:!0,hasMoreEvents:!1,userEventsContainerKey:e.userEventsContainerKey+1,isResetFilter:!1}})),n.state.activeTabIndex){case 0:n.loadEvents(Ce.MandatoryEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;case 1:n.loadEvents(Ce.AllPublicPrivateEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;default:n.setState({isLoadingEvents:!1})}},n.formatEventsCount=function(e){return-1===e?"":e<I.lazyLoadEventsCount?"(".concat(e,")"):"(".concat(I.lazyLoadEventsCount,"+)")},n.renderTabMenuItems=function(){return[{key:"mandatory-user-events",content:"".concat(n.localize("mandatoryEventsTab")," ").concat(n.formatEventsCount(n.mandatoryEventsCount))},{key:"all-user-events",content:"".concat(n.localize("allEventsTab")," ").concat(n.formatEventsCount(n.allEventsCount))}]},n.renderEvents=function(){if(n.state.isLoadingEvents)return i.createElement(ae.a,null,i.createElement(ne.a,{className:"loader"}));var e=[];return 0===n.state.activeTabIndex?e=Object(oe.a)(n.state.mandatoryEvents):1===n.state.activeTabIndex&&(e=Object(oe.a)(n.state.allEvents)),e&&0!==e.length?i.createElement(f.a,{className:n.state.isFilterOpen?"filter-open":void 0},i.createElement(_e,{key:"discover-events-".concat(n.state.userEventsContainerKey),events:e,hasMoreEvents:n.state.hasMoreEvents,loadMoreEvents:n.getEvents,onClick:n.onEventClick})):i.createElement(Ke,{message:n.localize("eventsNotAvailable")})},n.renderFilterButtonIcon=function(){return n.state.filteredCategories&&n.state.filteredCategories.length>0||n.state.filteredUsers&&n.state.filteredUsers.length>0?i.createElement(re.a,{iconName:"FilterSolid"}):i.createElement(re.a,{iconName:"Filter"})},n.renderDesktopView=function(){return i.createElement(Ie.a,{dir:n.props.dir},i.createElement(f.a,{column:!0},i.createElement(f.a,{space:"between",vAlign:"center"},i.createElement(ct,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.a.Item,{push:n.props.dir===ie.Ltr},i.createElement(f.a,{gap:"gap.medium",vAlign:"center"},i.createElement(Ae.a,{className:n.props.dir===ie.Rtl?"rtl-left-margin-medium":"",trigger:i.createElement(te.a,{icon:n.renderFilterButtonIcon(),content:n.localize("filterButtonText"),onClick:n.onFilterBarToggle,"data-testid":"filterbutton"})}),i.createElement(ze.a,{inverted:!0,value:n.state.searchText,icon:i.createElement(be.SearchIcon,null),iconPosition:n.props.dir===ie.Rtl?"start":"end",placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",maxWidth:"20rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange,"data-testid":"search_input"})))),i.createElement(st,{isVisible:n.state.isFilterOpen,isReset:n.state.isResetFilter,categoryList:n.state.categoriesInFilter,createdByList:n.state.lnDTeamMembersInFilter,onFilterBarCloseClick:n.onFilterBarClose,onFilterChange:n.onFilterChange})),n.renderEvents())},n.renderMobileView=function(){return i.createElement(Ie.a,{dir:n.props.dir},i.createElement(f.a,{column:!0},i.createElement(f.a,{space:"between"},i.createElement(ct,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.a.Item,{push:!0},i.createElement(f.a,{gap:"gap.medium",vAlign:"center"},i.createElement(Ae.a,{trigger:i.createElement(te.a,{text:!0,iconOnly:!0,icon:n.renderFilterButtonIcon(),onClick:n.onMobileFilterButtonClick})}),i.createElement(be.SearchIcon,{onClick:function(){return n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen})}})))),n.state.isMobileSearchBoxOpen&&!n.state.isFilterOpen&&i.createElement(f.a,{className:"search-box",vAlign:"center",gap:"gap.small"},i.createElement(ze.a,{inverted:!0,fluid:!0,value:n.state.searchText,placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",width:"100rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.a.Item,{push:!0},i.createElement(be.CloseIcon,{className:"close-searchbox-icon",onClick:n.onMobileSearchBoxClose})))),!n.state.isFilterOpen&&n.renderEvents())},n.searchText="",n.localize=n.props.t,n.timeout=null,n.mandatoryEventsCount=-1,n.allEventsCount=-1,n.state={mandatoryEvents:[],allEvents:[],hasMoreEvents:!1,userEventsContainerKey:0,isLoadingEvents:!0,activeTabIndex:0,isFilterOpen:!1,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:Se.Recent,categoriesInFilter:[],lnDTeamMembersInFilter:[],isResetFilter:!1,notification:{id:0,message:"",type:nt.None},isMobileView:!1,isMobileSearchBoxOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.screenResize.bind(this)),this.screenResize(),this.loadEventCategories(),this.loadAllLnDTeamMembers(),vt();var t=this.getEventsAsync(Ce.MandatoryEventsForUser),a=this.getEventsAsync(Ce.AllPublicPrivateEventsForUser);Promise.all([t,a]).then((function(t){e.setTotalEventsCount(Ce.MandatoryEventsForUser,t[0].length),e.setTotalEventsCount(Ce.AllPublicPrivateEventsForUser,t[1].length)})).finally((function(){e.getEvents()}))}},{key:"render",value:function(){return i.createElement("div",{className:"container-div"},i.createElement("div",{className:"discover-events-container"},this.state.isMobileView?this.renderMobileView():this.renderDesktopView(),i.createElement(dt,{dir:this.props.dir,notification:this.state.notification})))}}]),a}(i.Component)),ht=Object(U.a)()(ye(gt)),ft=(a(841),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).teamId=void 0,n.localize=void 0,n.searchText=void 0,n.timeout=void 0,n.registeredEventsCount=void 0,n.completedEventsCount=void 0,n.resize=function(){n.setState({isMobileView:window.innerWidth<=I.maxWidthForMobileView})},n.loadEventCategories=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({categoriesInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.loadAllLnDTeamMembers=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&n.setState({lnDTeamMembersInFilter:a.data});case 4:case"end":return e.stop()}}),e)}))),n.getEventsAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s,o,c=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>1&&void 0!==c[1]?c[1]:0,t!==Ce.RegisteredEventsForUser){e.next=7;break}return e.next=4,Y(n.state.searchText,i,Ce.RegisteredEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 4:s=e.sent,e.next=10;break;case 7:return e.next=9,Y(n.state.searchText,i,Ce.CompletedEventsForUser,n.state.filteredUsers,n.state.filteredCategories,n.state.sortByFilter);case 9:s=e.sent;case 10:return o=[],s&&s.status===r.OK&&(null===(a=s.data)||void 0===a?void 0:a.length)>0&&(o=s.data),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.loadEvents=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,r,i,s,o,c,l,u,d=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:0,e.next=3,n.getEventsAsync(t,a);case 3:if(!(r=e.sent)){e.next=14;break}e.t0=t,e.next=e.t0===Ce.RegisteredEventsForUser?8:e.t0===Ce.CompletedEventsForUser?10:11;break;case 8:return a>0?(i=Object(oe.a)(r),s=Object(oe.a)(n.state.registeredEvents),o=i.filter((function(e){return-1===s.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({registeredEvents:s.concat(o),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})):(n.setTotalEventsCount(Ce.RegisteredEventsForUser,r.length),n.setState({registeredEvents:Object(oe.a)(r),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})),e.abrupt("break",12);case 10:a>0?(c=Object(oe.a)(r),l=Object(oe.a)(n.state.completedEvents),u=c.filter((function(e){return-1===l.findIndex((function(t){return t.eventId===e.eventId}))})),n.setState({completedEvents:l.concat(u),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)})):(n.setTotalEventsCount(Ce.CompletedEventsForUser,r.length),n.setState({completedEvents:Object(oe.a)(r),hasMoreEvents:!(r.length<I.lazyLoadEventsCount)}));case 11:return e.abrupt("break",12);case 12:e.next=15;break;case 14:0===a?(n.setTotalEventsCount(t,0),t===Ce.RegisteredEventsForUser?n.setState({registeredEvents:[],hasMoreEvents:!1}):n.setState({completedEvents:[],hasMoreEvents:!1})):n.setState({hasMoreEvents:!1});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.setTotalEventsCount=function(e,t){var a,r;if((!n.state.searchText||""===n.state.searchText.trim())&&!(null===(a=n.state.filteredCategories)||void 0===a?void 0:a.length)&&!(null===(r=n.state.filteredUsers)||void 0===r?void 0:r.length))switch(e){case Ce.RegisteredEventsForUser:n.registeredEventsCount=t;break;case Ce.CompletedEventsForUser:n.completedEventsCount=t}},n.onEventClick=function(e){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/register-remove?eventId=").concat(e.eventId,"&teamId=").concat(e.teamId,"&isMobileView=").concat(n.state.isMobileView),height:746,width:600,title:n.localize("eventDetailsStep1")},(function(t,a){if(a&&a.isSuccess){var r=(n.state.registeredEvents?Object(oe.a)(n.state.registeredEvents):[]).filter((function(t){return t.eventId!==e.eventId}));n.registeredEventsCount-=1,n.setState((function(e){return{registeredEvents:r,notification:{id:e.notification.id+1,message:a.type===j.Register?n.localize("eventRegistrationSuccessfulMessage"):n.localize("eventUnregistrationSuccessfulMessage"),type:nt.Success}}}))}}))},n.onTabIndexChange=function(e){n.timeout&&window.clearTimeout(n.timeout),vt(),n.setState({isLoadingEvents:!0,activeTabIndex:null===e||void 0===e?void 0:e.activeIndex,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:Se.Recent,isResetFilter:!0},(function(){n.timeout=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&n.getEvents();case 1:case"end":return t.stop()}}),t)}))),700)}))},n.onSearchEvents=function(e){13===e.keyCode&&""!==n.state.searchText.trim()&&n.getEvents()},n.onSearchTextChange=function(e){e.target.value.length?n.setState({searchText:e.target.value}):n.setState({searchText:""},(function(){n.getEvents()}))},n.onFilterBarToggle=function(){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,isResetFilter:!1}}))},n.onMobileFilterButtonClick=function(){n.props.microsoftTeams.tasks.startTask({url:"".concat(window.location.origin,"/mobile-filter"),height:746,width:600,title:n.localize("mobileFilterTitle")},(function(e,t){if(t&&t.isFilterStateChanged){var a=localStorage.getItem(at.userEventsMobileFilteredCategoriesLocalStorageKey),r=localStorage.getItem(at.userEventsMobileFilteredUsersLocalStorageKey),i=localStorage.getItem(at.userEventsMobileSortByFilterLocalStorageKey);n.setState({filteredCategories:a||"",filteredUsers:r||"",sortByFilter:i||0},(function(){return n.getEvents()}))}}))},n.onFilterBarClose=function(e){n.setState((function(e){return{isFilterOpen:!e.isFilterOpen,filteredCategories:"",filteredUsers:"",sortByFilter:Se.Recent,isResetFilter:!0}}),(function(){e&&n.getEvents()}))},n.onFilterChange=function(e,t,a){var r=e||[],i=t||[];n.setState({filteredCategories:r.join(";"),filteredUsers:i.join(";"),sortByFilter:a},(function(){n.getEvents()}))},n.onMobileSearchBoxClose=function(){var e;n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen}),(null===(e=n.state.searchText)||void 0===e?void 0:e.trim().length)&&n.setState({searchText:""},(function(){return n.getEvents()}))},n.getEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(0===e&&n.setState((function(e){return{isLoadingEvents:!0,hasMoreEvents:!1,userEventsContainerKey:e.userEventsContainerKey+1,isResetFilter:!1}})),n.state.activeTabIndex){case 0:n.loadEvents(Ce.RegisteredEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;case 1:n.loadEvents(Ce.CompletedEventsForUser,e).finally((function(){n.setState({isLoadingEvents:!1})}));break;default:n.setState({isLoadingEvents:!1})}},n.formatEventsCount=function(e){return-1===e?"":e<I.lazyLoadEventsCount?"(".concat(e,")"):"(".concat(I.lazyLoadEventsCount,"+)")},n.renderTabMenuItems=function(){return[{key:"registered-user-events",content:"".concat(n.localize("registeredEventsTab")," ").concat(n.formatEventsCount(n.registeredEventsCount))},{key:"completed-user-events",content:"".concat(n.localize("completedEventsTab")," ").concat(n.formatEventsCount(n.completedEventsCount))}]},n.renderEvents=function(){if(n.state.isLoadingEvents)return i.createElement(ae.a,null,i.createElement(ne.a,{className:"loader"}));var e=[];return 0===n.state.activeTabIndex?e=Object(oe.a)(n.state.registeredEvents):1===n.state.activeTabIndex&&(e=Object(oe.a)(n.state.completedEvents)),e&&0!==e.length?i.createElement(f.a,{className:n.state.isFilterOpen?"filter-open":void 0},i.createElement(_e,{key:"my-events-".concat(n.state.userEventsContainerKey),events:e,hasMoreEvents:n.state.hasMoreEvents,loadMoreEvents:n.getEvents,onClick:n.onEventClick})):i.createElement(Ke,{message:n.localize("eventsNotAvailable")})},n.renderFilterButtonIcon=function(){return n.state.filteredCategories&&n.state.filteredCategories.length>0||n.state.filteredUsers&&n.state.filteredUsers.length>0?i.createElement(re.a,{iconName:"FilterSolid"}):i.createElement(re.a,{iconName:"Filter"})},n.renderDesktopView=function(){return i.createElement(Ie.a,{dir:n.props.dir},i.createElement(f.a,{column:!0},i.createElement(f.a,{space:"between",vAlign:"center"},i.createElement(ct,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.a.Item,{push:n.props.dir===ie.Ltr},i.createElement(f.a,{gap:"gap.medium",vAlign:"center"},i.createElement(Ae.a,{className:n.props.dir===ie.Rtl?"rtl-left-margin-medium":"",trigger:i.createElement(te.a,{icon:n.renderFilterButtonIcon(),content:n.localize("filterButtonText"),onClick:n.onFilterBarToggle,"data-testid":"filterbutton"})}),i.createElement(ze.a,{inverted:!0,value:n.state.searchText,icon:i.createElement(be.SearchIcon,null),iconPosition:n.props.dir===ie.Rtl?"start":"end",placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",maxWidth:"20rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange,"data-testid":"search_input"})))),i.createElement(st,{isVisible:n.state.isFilterOpen,isReset:n.state.isResetFilter,categoryList:n.state.categoriesInFilter,createdByList:n.state.lnDTeamMembersInFilter,onFilterBarCloseClick:n.onFilterBarClose,onFilterChange:n.onFilterChange})),n.renderEvents())},n.renderMobileView=function(){return i.createElement(Ie.a,{dir:n.props.dir},i.createElement(f.a,{column:!0},i.createElement(f.a,{space:"between"},i.createElement(ct,{defaultTabIndex:0,activeTabIndex:n.state.activeTabIndex,tabItems:n.renderTabMenuItems(),onTabIndexChange:n.onTabIndexChange}),i.createElement(f.a.Item,{push:!0},i.createElement(f.a,{gap:"gap.medium",vAlign:"center"},i.createElement(Ae.a,{trigger:i.createElement(te.a,{text:!0,iconOnly:!0,icon:n.renderFilterButtonIcon(),onClick:n.onMobileFilterButtonClick})}),i.createElement(be.SearchIcon,{onClick:function(){return n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen})}})))),n.state.isMobileSearchBoxOpen&&!n.state.isFilterOpen&&i.createElement(f.a,{className:"search-box",vAlign:"center",gap:"gap.small"},i.createElement(ze.a,{inverted:!0,fluid:!0,value:n.state.searchText,placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",width:"100rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.a.Item,{push:!0},i.createElement(be.CloseIcon,{className:"close-searchbox-icon",onClick:n.onMobileSearchBoxClose})))),!n.state.isFilterOpen&&n.renderEvents())},n.teamId="",n.searchText="",n.localize=n.props.t,n.timeout=null,n.registeredEventsCount=-1,n.completedEventsCount=-1,n.state={registeredEvents:[],completedEvents:[],hasMoreEvents:!1,userEventsContainerKey:0,isLoadingEvents:!0,activeTabIndex:0,isFilterOpen:!1,searchText:"",filteredCategories:"",filteredUsers:"",sortByFilter:Se.Recent,categoriesInFilter:[],lnDTeamMembersInFilter:[],isResetFilter:!1,notification:{id:0,message:"",type:nt.None},isMobileView:!1,isMobileSearchBoxOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.resize.bind(this)),this.resize(),this.loadEventCategories(),this.loadAllLnDTeamMembers(),vt();var t=this.getEventsAsync(Ce.RegisteredEventsForUser),a=this.getEventsAsync(Ce.CompletedEventsForUser);Promise.all([t,a]).then((function(t){e.setTotalEventsCount(Ce.RegisteredEventsForUser,t[0].length),e.setTotalEventsCount(Ce.CompletedEventsForUser,t[1].length)})).finally((function(){e.getEvents()}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"render",value:function(){return i.createElement("div",{className:"container-div"},i.createElement("div",{className:"my-events-container"},this.state.isMobileView?this.renderMobileView():this.renderDesktopView(),i.createElement(dt,{dir:this.props.dir,notification:this.state.notification})))}}]),a}(i.Component)),Et=Object(U.a)()(ye(ft)),bt=(a(326),i.memo((function(e){var t=Object(Ze.a)().t,a=i.useState({checkboxes:e.content.checkboxes}),n=Object(Oe.a)(a,2),r=n[0],s=(n[1],i.useState(e.content.checkboxes)),o=Object(Oe.a)(s,2),c=o[0],l=o[1],u=i.useState(""),d=Object(Oe.a)(u,2),m=d[0],p=d[1],v=i.useState(!0),g=Object(Oe.a)(v,2),h=g[0],E=g[1],b=i.useState(!1),y=Object(Oe.a)(b,2),C=y[0],S=y[1];i.useEffect((function(){w(e.content.checkboxes)}),[]);var k=function(t,a){S(!0);var n=r.checkboxes.map((function(e){return e.key===t&&(e.isChecked=a),e})),i=n.reduce((function(e,t){return t.isChecked?e+1:e}),0);E(i<=0);var s=n;m.trim().length&&(s=n.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}))),w(s),e.onCheckboxStateChange(n)},w=function(e){e||(e=[]);var t=Object(oe.a)(e).slice(0,50);l(t)};return e.isOpen?i.createElement(ae.a,null,i.createElement("div",{className:"accordion-content-items-wrapper"},e.showSearchBar&&i.createElement("div",{className:"accordion-content-items-headerfooter"},i.createElement(ze.a,{icon:i.createElement(qe.a,null),placeholder:t("searchPlaceholder"),value:m,fluid:!0,onChange:function(e){return function(e){if(p(e),e.trim().length>0){var t=r.checkboxes.filter((function(t){return!0===t.title.toLowerCase().includes(e.toLowerCase())}));w(t)}else w(r.checkboxes)}(e.target.value)}})),i.createElement(ee.a,{className:"accordion-filter-popup-menu-divider"}),i.createElement("div",{className:"accordion-content-items-headerfooter"},i.createElement(f.a,{gap:"gap.small",vAlign:"center",hAlign:"end"},i.createElement(f.a.Item,{push:!0},i.createElement("div",null)),i.createElement(te.a,{disabled:C?h:e.disableClear,className:0===e.selectedCount?"clear-button ":"clear-button enable-clear",size:"small",text:!0,onClick:function(){return function(){var t=r.checkboxes.map((function(e){return e.isChecked=!1,e})),a=t;m.trim().length&&(a=t.filter((function(e){return e.title.toLowerCase().includes(m.toLowerCase())}))),w(a),e.onCheckboxStateChange(t),E(!0),S(!0)}()},content:e.selectedCount>0?t("clear")+"("+e.selectedCount.toString()+")":t("clear")}))),i.createElement("div",{className:"accordion-content-items-body"},c.map((function(e){if(e.title.trim().length)return i.createElement(f.a,{gap:"gap.small"},i.createElement(Ye.a,{className:"checkbox-wrapper",label:e.checkboxLabel,key:e.key,checked:e.isChecked,onChange:function(t,a){return k(e.key,a.checked)}}))}))))):i.createElement(i.Fragment,null)}))),yt=i.memo((function(e){return e.isOpen?i.createElement(i.Fragment,null,i.createElement("div",{className:"accordion-content-items-wrapper radio-popup-content"},i.createElement("div",{className:"accordion-content-items-body"},i.createElement(f.a,{gap:"gap.small"},i.createElement(Xe.a,{defaultCheckedValue:e.selectedValue,vertical:!0,items:e.content.radioGroupItems,onCheckedValueChange:function(t,a){return e.onRadiogroupStateChange(a.value)}}))))):i.createElement(i.Fragment,null)})),Ct=i.memo((function(e){var t=i.useState(!1),a=Object(Oe.a)(t,2),n=a[0],r=a[1],s=function(){r(!n),e.onFilterOpenChange(!n)};return e.checkboxes?i.createElement("div",{className:"accordion-container"},i.createElement("div",{className:"accordion-main",onClick:function(){return s()}},i.createElement(f.a,null,i.createElement(f.a.Item,null,i.createElement(b.a,{content:e.title})),i.createElement(f.a.Item,{push:!0},i.createElement(Je.a,null)))),i.createElement(bt,{isOpen:e.isFilterOpen,disableClear:0===e.selectedCount,selectedCount:e.selectedCount,showSearchBar:e.showSearchBar,content:{checkboxes:e.checkboxes,title:e.title},onCheckboxStateChange:e.onCheckboxStateChange})):e.radioGroup?i.createElement("div",{className:"accordion-container"},i.createElement("div",{className:"accordion-main",onClick:function(){return s()}},i.createElement(f.a,null,i.createElement(f.a.Item,null,i.createElement(b.a,{content:e.title})),i.createElement(f.a.Item,{push:!0},i.createElement(Je.a,null)))),i.createElement(yt,{isOpen:e.isFilterOpen,selectedValue:e.selectedSortBy,content:{radioGroupItems:e.radioGroup,title:e.title},onRadiogroupStateChange:e.onRadiogroupStateChange})):i.createElement(i.Fragment,null)})),St=(a(842),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.sortByList=[],n.isFilterStateChanged=void 0,n.loadEventCategories=Object(h.a)(g.a.mark((function e(){var t,a,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&a&&a.status===r.OK&&(null===(s=a.data)||void 0===s?void 0:s.length)>0&&n.setState({categoryList:a.data.map((function(e){return{isChecked:!1,key:e.categoryId,title:e.name,checkboxLabel:i.createElement(b.a,{content:e.name})}}))});case 4:case"end":return e.stop()}}),e)}))),n.loadAllLnDTeamMembers=Object(h.a)(g.a.mark((function e(){var t,a,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt();case 2:(a=e.sent)&&a.status===r.OK&&(null===(t=a.data)||void 0===t?void 0:t.length)>0&&a&&a.status===r.OK&&(null===(s=a.data)||void 0===s?void 0:s.length)>0&&n.setState({createdByList:a.data.map((function(e){return{isChecked:!1,key:e.aadObjectId,title:e.name,checkboxLabel:i.createElement(b.a,{content:e.name})}}))});case 4:case"end":return e.stop()}}),e)}))),n.loadFilterItems=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.loadEventCategories(),a=n.loadAllLnDTeamMembers(),Promise.all([t,a]).finally((function(){var e=localStorage.getItem(at.userEventsMobileFilteredCategoriesLocalStorageKey),t=localStorage.getItem(at.userEventsMobileFilteredUsersLocalStorageKey),a=localStorage.getItem(at.userEventsMobileSortByFilterLocalStorageKey),r=Object(oe.a)(n.state.categoryList),i=0;if((null===e||void 0===e?void 0:e.trim().length)&&(null===r||void 0===r?void 0:r.length)>0)for(var s=r.filter((function(t){return e&&e.indexOf(t.key)>-1})),o=0;o<s.length;o++)s[o].isChecked=!0,i+=1;var c=Object(oe.a)(n.state.createdByList),l=0;if((null===t||void 0===t?void 0:t.trim().length)&&(null===c||void 0===c?void 0:c.length)>0)for(var u=c.filter((function(e){return t&&t.indexOf(e.key)>-1})),d=0;d<u.length;d++)u[d].isChecked=!0,l+=1;var m=n.state.selectedSortBy;if(null===a||void 0===a?void 0:a.trim().length){var p,v=null===(p=n.sortByList)||void 0===p?void 0:p.find((function(e){return e.key.toString()===(null===a||void 0===a?void 0:a.trim())}));v&&(m=v.key)}n.setState({categoryList:r,categorySelectedCount:i,createdByList:c,createdBySelectedCount:l,selectedSortBy:m,isLoading:!1})}));case 3:case"end":return e.stop()}}),e)}))),n.resize=function(){window.innerWidth!==n.state.screenWidth&&n.setState({screenWidth:window.innerWidth})},n.onCategoryStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.setState({categoryList:e,categorySelectedCount:t&&t.length},(function(){return n.isFilterStateChanged=!0}))},n.onCreatedByStateChange=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.isChecked}));n.setState({createdByList:e,createdBySelectedCount:t?t.length:0},(function(){return n.isFilterStateChanged=!0}))},n.onSortByStateChange=function(e){n.setState({selectedSortBy:e},(function(){return n.isFilterStateChanged=!0}))},n.onCloseIconClick=function(){if(n.state.searchText.trim().length>0&&n.setState({searchText:""}),n.state.categoryList.filter((function(e){return e.isChecked})).length){var e=n.state.categoryList.map((function(e){return e.isChecked=!1,e}));n.setState({categoryList:e})}if(n.state.createdByList.filter((function(e){return e.isChecked})).length){var t=n.state.createdByList.map((function(e){return e.isChecked=!1,e}));n.setState({createdByList:t})}n.setState({selectedSortBy:n.sortByList[0].value})},n.onCategoriesFilterOpenStateChange=function(e){e?n.setState({isCategoriesFilterOpen:!0,isCreatedByFilterOpen:!1,isSortByFilterOpen:!1}):n.setState({isCategoriesFilterOpen:!1})},n.onCreatedByFilterOpenStateChange=function(e){e?n.setState({isCategoriesFilterOpen:!1,isCreatedByFilterOpen:!0,isSortByFilterOpen:!1}):n.setState({isCreatedByFilterOpen:!1})},n.onSortByFilterOpenStateChange=function(e){e?n.setState({isCategoriesFilterOpen:!1,isCreatedByFilterOpen:!1,isSortByFilterOpen:!0}):n.setState({isSortByFilterOpen:!1})},n.onClearFilter=function(){var e=n.state.categoryList?Object(oe.a)(n.state.categoryList):[],t=n.state.createdByList?Object(oe.a)(n.state.createdByList):[];n.setState({categoryList:e.map((function(e){return e.isChecked=!1,e})),categorySelectedCount:0,createdByList:t.map((function(e){return e.isChecked=!1,e})),createdBySelectedCount:0,selectedSortBy:Se.Recent},(function(){n.isFilterStateChanged=!0}))},n.onApplyFilter=function(){var e=(n.state.categoryList?Object(oe.a)(n.state.categoryList):[]).filter((function(e){return e.isChecked})).map((function(e){return e.key}));localStorage.setItem(at.userEventsMobileFilteredCategoriesLocalStorageKey,e.join(";"));var t=(n.state.createdByList?Object(oe.a)(n.state.createdByList):[]).filter((function(e){return e.isChecked})).map((function(e){return e.key}));localStorage.setItem(at.userEventsMobileFilteredUsersLocalStorageKey,t.join(";")),localStorage.setItem(at.userEventsMobileSortByFilterLocalStorageKey,n.state.selectedSortBy.toString()),n.props.microsoftTeams.tasks.submitTask({isFilterStateChanged:n.isFilterStateChanged})},Object(He.a)(),n.localize=n.props.t,n.sortByList=rt(n.localize).map((function(e){return{key:e.id,label:e.name,value:e.id,name:e.name}})),n.isFilterStateChanged=!1,n.state={selectedSortBy:n.sortByList[0].value,categoryList:[],createdByList:[],searchText:"",screenWidth:800,createdBySelectedCount:0,categorySelectedCount:0,isLoading:!0,isCategoriesFilterOpen:!1,isCreatedByFilterOpen:!1,isSortByFilterOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.loadFilterItems(),window.addEventListener("resize",this.resize.bind(this)),this.resize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"render",value:function(){return this.state.isLoading?i.createElement(ae.a,null,i.createElement(ne.a,{className:"loader"})):i.createElement(ae.a,{className:"mobile-filter-bar-container"},i.createElement(f.a,{className:"mobile-filter-buttons"},i.createElement(f.a.Item,{push:!0},i.createElement(f.a,{gap:"gap.small",vAlign:"center"},i.createElement(te.a,{content:this.localize("mobileFilterClearButtonText"),onClick:this.onClearFilter}),i.createElement(te.a,{primary:!0,content:this.localize("mobileFilterApplyButtonText"),onClick:this.onApplyFilter})))),i.createElement(f.a,{className:"filter-bar mobile-filter-wrapper"},i.createElement("div",{className:"menu-wrapper"},i.createElement(Ct,{isFilterOpen:this.state.isCategoriesFilterOpen,title:"".concat(this.localize("category")," ").concat(this.state.categorySelectedCount>0?"(".concat(this.state.categorySelectedCount," ").concat(this.localize("selected"),")"):""),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.categorySelectedCount,checkboxes:this.state.categoryList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCategoryStateChange,onFilterOpenChange:this.onCategoriesFilterOpenStateChange}),i.createElement(Ct,{isFilterOpen:this.state.isCreatedByFilterOpen,title:"".concat(this.localize("createdBy")," ").concat(this.state.createdBySelectedCount>0?"(".concat(this.state.createdBySelectedCount," ").concat(this.localize("selected"),")"):""),showSearchBar:!0,selectedSortBy:this.state.selectedSortBy,selectedCount:this.state.createdBySelectedCount,checkboxes:this.state.createdByList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onFilterOpenChange:this.onCreatedByFilterOpenStateChange}),i.createElement(Ct,{isFilterOpen:this.state.isSortByFilterOpen,title:this.sortByList[this.state.selectedSortBy].name,selectedCount:this.state.createdBySelectedCount,selectedSortBy:this.state.selectedSortBy,radioGroup:this.sortByList,onRadiogroupStateChange:this.onSortByStateChange,onCheckboxStateChange:this.onCreatedByStateChange,onFilterOpenChange:this.onSortByFilterOpenStateChange}))))}}]),a}(i.Component)),kt=Object(U.a)()(ye(St)),wt=a(238),xt=a(170),Dt=a(239),Ot=Object(U.a)()((function(e){var t=e.t,a=[{icon:i.createElement(be.EditIcon,{outline:!0}),content:t("editEventInformation"),onClick:function(){return e.onEditEvent(e.eventDetails.eventId)}},{icon:i.createElement(be.ArrowDownIcon,null),content:t("exportRegistrationDetails"),onClick:function(){return e.onExportDetails(e.eventDetails.eventId,e.eventDetails.name)}},{icon:i.createElement(be.BellIcon,{outline:!0}),content:t("sendReminder"),onClick:function(){return e.onSendReminder(e.eventDetails.eventId)}},{kind:"divider"},{icon:i.createElement(be.CloseIcon,{outline:!0}),content:t("cancelEvent"),onClick:function(){return e.onCancelEvent(e.eventDetails.eventId)}}],n=[{icon:i.createElement(be.EditIcon,{outline:!0}),content:t("editEventInformation"),onClick:function(){return e.onEditEvent(e.eventDetails.eventId)}},{kind:"divider"},{icon:i.createElement(be.CloseIcon,{outline:!0}),content:t("deleteDraft"),onClick:function(){return e.onDeleteDraftEvent(e.eventDetails.eventId,e.eventDetails.name)}}],r=[{icon:i.createElement(be.ArrowDownIcon,null),content:t("exportRegistrationDetails"),onClick:function(){return e.onExportDetails(e.eventDetails.eventId,e.eventDetails.name)}}];return i.createElement(Ae.a,{trigger:i.createElement(te.a,{text:!0,iconOnly:!0,icon:i.createElement(be.MoreIcon,null)}),menu:{items:function(){switch(e.eventDetails.status){case F.Draft:return n;case F.Active:return new Date<R.a.utc(e.eventDetails.endDate).local().toDate()?(e.eventDetails.isRegistrationClosed||a.unshift({icon:i.createElement(be.UserFriendsIcon,{outline:!0}),content:t("closeRegistration"),onClick:function(){return e.onCloseRegistration(e.eventDetails.eventId)}}),a):r}}()},position:"before",className:e.dir===ie.Rtl?"ltr-direction":""})})),Tt=function(){var e=Object(h.a)(g.a.mark((function e(t,a,n,r){var i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="".concat(I.apiBaseURL,"/EventWorkflow"),s=W({searchString:encodeURIComponent(t),eventSearchType:n,teamId:r,pageCount:a}),e.next=4,T.get(i,s);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),It=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/Event"),r=W({eventId:t,teamId:a}),e.next=4,T.get(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Nt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/EventWorkflow/CloseEventRegistrations"),r=W({eventId:a,teamId:t}),e.next=4,T.patch(n,null,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Lt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/EventWorkflow/CancelEvent"),r=W({eventId:a,teamId:t}),e.next=4,T.patch(n,null,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Pt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/EventWorkflow/delete-draft"),r=W({eventId:a,teamId:t}),e.next=4,T.delete(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),At=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/eventfiles/ExportEventDetailsToCSV"),r=W({eventId:a,teamId:t}),e.next=4,T.get(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),zt=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/EventWorkflow/SendReminder"),r=W({eventId:a,teamId:t}),e.next=4,T.post(n,null,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),jt=(a(441),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.draftEventsCount=void 0,n.completedEventsCount=void 0,n.activeEventsCount=void 0,n.teamId=void 0,n.timeout=void 0,n.eventsScrollAreaRef=void 0,n.componentWillReceiveProps=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.teamsContext===t.teamsContext){e.next=18;break}if(!t.teamsContext){e.next=18;break}if(n.teamId=t.teamsContext.teamId,-1!==n.activeEventsCount||-1!==n.draftEventsCount||-1!==n.completedEventsCount){e.next=18;break}return n.activeEventsCount=n.draftEventsCount=n.completedEventsCount=0,e.next=7,n.getEventsAsync(0,Ce.ActiveEventsForTeam);case 7:return a=e.sent,e.next=10,n.getEventsAsync(0,Ce.DraftEventsForTeam);case 10:return r=e.sent,e.next=13,n.getEventsAsync(0,Ce.CompletedEventsForTeam);case 13:i=e.sent,n.setTotalEventsCount(Ce.ActiveEventsForTeam,a.length),n.setTotalEventsCount(Ce.DraftEventsForTeam,r.length),n.setTotalEventsCount(Ce.CompletedEventsForTeam,i.length),n.getEvents();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.getEventsAsync=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt(n.state.searchText,t,a,n.teamId);case 2:return i=e.sent,s=[],i&&i.status===r.OK&&i.data&&(s=i.data),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.loadEvents=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var r,i,s,o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getEventsAsync(t,a);case 2:if(!(r=e.sent)){e.next=16;break}i=!(r.length<I.lazyLoadEventsCount),e.t0=a,e.next=e.t0===Ce.DraftEventsForTeam?8:e.t0===Ce.CompletedEventsForTeam?10:12;break;case 8:return 0===t?(n.setTotalEventsCount(Ce.DraftEventsForTeam,r.length),n.setState({draftEvents:Object(oe.a)(r),loadMoreEvents:i})):(s=Object(oe.a)(n.state.draftEvents),n.setState({draftEvents:[].concat(Object(oe.a)(s),Object(oe.a)(r)),loadMoreEvents:i})),e.abrupt("break",14);case 10:return 0===t?(n.setTotalEventsCount(Ce.CompletedEventsForTeam,r.length),n.setState({completedEvents:Object(oe.a)(r),loadMoreEvents:i})):(o=Object(oe.a)(n.state.completedEvents),n.setState({completedEvents:[].concat(Object(oe.a)(o),Object(oe.a)(r)),loadMoreEvents:i})),e.abrupt("break",14);case 12:return 0===t?(n.setTotalEventsCount(Ce.ActiveEventsForTeam,r.length),n.setState({activeEvents:Object(oe.a)(r),loadMoreEvents:i})):(c=Object(oe.a)(n.state.activeEvents),n.setState({activeEvents:[].concat(Object(oe.a)(c),Object(oe.a)(r)),loadMoreEvents:i})),e.abrupt("break",14);case 14:e.next=18;break;case 16:0===t&&n.setTotalEventsCount(a,0),n.setState({loadMoreEvents:!1});case 18:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.setTotalEventsCount=function(e,t){if(!n.state.searchText||""===n.state.searchText.trim())switch(e){case Ce.DraftEventsForTeam:n.draftEventsCount=t;break;case Ce.CompletedEventsForTeam:n.completedEventsCount=t;break;case Ce.ActiveEventsForTeam:n.activeEventsCount=t}},n.getEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(0===e&&n.setState((function(e){return{isLoading:!0,loadMoreEvents:!1,infiniteScrollKey:e.infiniteScrollKey+1}})),n.state.activeTabIndex){case 0:n.loadEvents(e,Ce.DraftEventsForTeam).finally((function(){n.setState({isLoading:!1})}));break;case 2:n.loadEvents(e,Ce.CompletedEventsForTeam).finally((function(){n.setState({isLoading:!1})}));break;default:n.loadEvents(e,Ce.ActiveEventsForTeam).finally((function(){n.setState({isLoading:!1})}))}},n.formatEventDateAndTime=function(e){if(e){var t=R.a.utc(e.startDate).local().format("DD MMM YYYY"),a=R.a.utc(e.startTime).local().format("HH:mm"),n=R.a.utc(e.endTime).local().format("HH:mm");return"".concat(t,", ").concat(a," - ").concat(n)}return""},n.onTabMenuIndexChange=function(e){n.timeout&&window.clearTimeout(n.timeout),n.setState({isLoading:!0,searchText:"",activeTabIndex:n.state.isMobileView?null===e||void 0===e?void 0:e.index:null===e||void 0===e?void 0:e.activeIndex}),n.timeout=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&n.getEvents();case 1:case"end":return t.stop()}}),t)}))),700)},n.onCloseRegistration=function(e){n.props.microsoftTeams.tasks.startTask({title:n.localize("closeRegistration"),height:746,width:600,url:"".concat(window.location.origin,"/close-or-cancel-event?operationType=").concat(j.CloseRegistration,"&eventId=").concat(e,"&teamId=").concat(n.teamId,"&isMobileView=").concat(n.state.isMobileView)},(function(e,t){t&&n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("closeRegistrationSuccessfulMessage"),type:nt.Success}}}))}))},n.onEditEvent=function(e){n.props.microsoftTeams.tasks.startTask({title:n.localize("editEvent"),height:746,width:600,url:"".concat(window.location.origin,"/create-event?eventId=").concat(e,"&isDraft=").concat(0===n.state.activeTabIndex)},(function(e,t){t&&(t.isSuccess?n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("updateEventSuccessfulMessage"),type:nt.Success},activeTabIndex:t.isCreateEvent?1:e.activeTabIndex}}),(function(){window.setTimeout((function(){return n.getEvents()}),2e3)})):n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("updateEventFailureMessage"),type:nt.Error}}})))}))},n.onSendReminder=function(){var e=Object(h.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zt(n.teamId,t);case 2:e.sent.status===r.OK?n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("sendReminderSuccessfulMessage"),type:nt.Success}}})):n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("sendReminderFailureMessage"),type:nt.Error}}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onCancelEvent=function(e){n.props.microsoftTeams.tasks.startTask({title:n.localize("cancelEvent"),height:746,width:600,url:"".concat(window.location.origin,"/close-or-cancel-event?operationType=").concat(j.CancelEvent,"&eventId=").concat(e,"&teamId=").concat(n.teamId,"&isMobileView=").concat(n.state.isMobileView)},(function(t,a){if(a){var r=(n.state.activeEvents?Object(oe.a)(n.state.activeEvents):[]).filter((function(t){return t.eventId!==e}));n.activeEventsCount-=1,n.setState((function(e){return{activeEvents:r,notification:{id:e.notification.id+1,message:n.localize("cancelEventSuccessfulMessage"),type:nt.Success}}}))}}))},n.onDeleteDraftEvent=function(e,t){n.props.microsoftTeams.tasks.startTask({title:n.localize("deleteEvent"),height:200,width:400,url:"".concat(window.location.origin,"/delete-draft?eventId=").concat(e,"&teamId=").concat(n.teamId)},(function(t,a){if(a){var r=(n.state.draftEvents?Object(oe.a)(n.state.draftEvents):[]).filter((function(t){return t.eventId!==e}));n.draftEventsCount-=1,n.setState((function(e){return{draftEvents:r,notification:{id:e.notification.id+1,message:n.localize("deleteDraftEvent"),type:nt.Success}}}))}}))},n.onExportDetails=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var i,s,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,At(n.teamId,t);case 2:(i=e.sent).status===r.OK?(s=window.URL.createObjectURL(new Blob(["\ufeff",i.data],{type:"text/csv;charset=utf-8"})),(o=document.createElement("a")).href=s,o.setAttribute("download","".concat(a,".csv")),o.click(),n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("exportDetailsSuccessfulMessage"),type:nt.Success}}}))):n.setState((function(e){return{notification:{id:e.notification.id+1,message:n.localize("exportDetailsFailureMessage"),type:nt.Error}}}));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.onSearchEvents=function(e){var t;13===e.keyCode&&(null===(t=n.state.searchText)||void 0===t?void 0:t.length)&&""!==n.state.searchText.trim()&&n.getEvents()},n.onSearchTextChange=function(e){e.target.value.length?n.setState({searchText:e.target.value}):n.setState({searchText:""},(function(){n.getEvents()}))},n.formatEventsCount=function(e){return-1===e?"":e<I.lazyLoadEventsCount?"(".concat(e,")"):"(".concat(I.lazyLoadEventsCount,"+)")},n.getTabMenuItems=function(){return[{key:"draft-events",content:"".concat(n.localize("draftEvents")," ").concat(n.formatEventsCount(n.draftEventsCount))},{key:"active-events",content:"".concat(n.localize("activeEvents")," ").concat(n.formatEventsCount(n.activeEventsCount))},{key:"completed-events",content:"".concat(n.localize("completedEvents")," ").concat(n.formatEventsCount(n.completedEventsCount))}]},n.onEventCreated=function(e,t){var a;t&&(t.isSuccess?n.setState((function(e){return{notification:{id:e.notification.id+1,message:t.isDraft?n.localize("createDraftSuccessfulMessage"):n.localize("createEventSuccessfulMessage"),type:nt.Success},activeTabIndex:t.isDraft?0:1}}),(function(){window.setTimeout((function(){return n.getEvents()}),2e3)})):n.setState((function(e){return{notification:{id:e.notification.id+1,message:t.isDraft?n.localize("createDraftFailureMessage"):n.localize("createEventFailureMessage"),type:nt.Error}}}))),null===(a=n.props.microsoftTeams)||void 0===a||a.getContext((function(e){n.teamId=e.teamId}))},n.onManageCategoriesClick=function(){n.props.microsoftTeams.tasks.startTask({title:n.localize("manageCategories"),height:600,width:900,url:"".concat(window.location.origin,"/manage-categories")},(function(){}))},n.onCreateEventsClick=function(){n.props.microsoftTeams.tasks.startTask({title:n.localize("createEvent"),height:746,width:600,url:"".concat(window.location.origin,"/create-event")},n.onEventCreated)},n.onMobileSearchBoxClose=function(){var e;n.setState({isMobileSearchBoxOpen:!n.state.isMobileSearchBoxOpen}),(null===(e=n.state.searchText)||void 0===e?void 0:e.trim().length)&&n.setState({searchText:""},(function(){return n.getEvents()}))},n.getEventsTableHeader=function(){return{items:[{content:n.localize("eventTitle")},{content:n.localize("dateAndTime"),design:{minWidth:"17vw",maxWidth:"17vw"}},{content:n.localize("venue"),design:{minWidth:"17vw",maxWidth:"17vw"}},{content:n.localize("noOfRegistrations"),design:{minWidth:"12vw",maxWidth:"12vw"}},{content:n.localize("category"),design:{minWidth:"15vw",maxWidth:"15vw"}},{design:{minWidth:"5vw",maxWidth:"5vw"}}]}},n.getEventType=function(e){return e.type===_.InPerson?e.venue:e.type===_.LiveEvent?n.localize("liveEvent"):n.localize("teamsMeeting")},n.renderMobileView=function(){return i.createElement("div",{className:"container-manage-events"},i.createElement(f.a,null,i.createElement(f.a.Item,{push:!0},i.createElement(f.a,{gap:"gap.small"},i.createElement(te.a,{primary:!0,content:n.localize("manageCategories"),onClick:n.onManageCategoriesClick}),i.createElement(te.a,{primary:!0,content:n.localize("createEvent"),onClick:n.onCreateEventsClick})))),i.createElement(f.a,{className:"mobile-menu-manage-events",space:"between",vAlign:"center"},i.createElement(wt.a,{button:n.getTabMenuItems()[n.state.activeTabIndex],menu:{activeIndex:n.state.activeTabIndex,items:n.getTabMenuItems()},onMenuItemClick:function(e,t){return n.onTabMenuIndexChange(t)},style:{width:"40rem !important"},className:"split-button"}),i.createElement(f.a.Item,{push:!0},i.createElement(be.SearchIcon,{onClick:n.onMobileSearchBoxClose}))),n.state.isMobileSearchBoxOpen&&i.createElement(f.a,{className:"manage-events-mobile-search-box",vAlign:"center",gap:"gap.small"},i.createElement(ze.a,{inverted:!0,fluid:!0,placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",width:"100rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.a.Item,{push:!0},i.createElement(be.CloseIcon,{onClick:n.onMobileSearchBoxClose}))),n.state.isLoading?i.createElement(ne.a,{className:"loader"}):i.createElement("div",{key:n.state.infiniteScrollKey,className:"manage-events-scroll-area-mobile"},i.createElement(Re.a,{pageStart:0,loadMore:n.getEvents,hasMore:n.state.loadMoreEvents,initialLoad:!1,loader:i.createElement("div",null,i.createElement(ne.a,null)),useWindow:!1},n.renderEvents())))},n.renderDesktopView=function(){return i.createElement("div",{className:"container-manage-events"},i.createElement(f.a,{space:"between",vAlign:"center"},i.createElement(ct,{tabItems:n.getTabMenuItems(),defaultTabIndex:1,activeTabIndex:n.state.activeTabIndex,onTabIndexChange:n.onTabMenuIndexChange}),i.createElement(f.a.Item,{push:n.props.dir===ie.Ltr},i.createElement(f.a,{gap:"gap.medium",vAlign:"center"},i.createElement(ze.a,{inverted:!0,value:n.state.searchText,icon:i.createElement(be.SearchIcon,null),iconPosition:n.props.dir===ie.Rtl?"start":"end",placeholder:n.localize("searchForEventsPlaceholder"),input:{design:{minWidth:"20rem",maxWidth:"20rem"}},onKeyUp:n.onSearchEvents,onChange:n.onSearchTextChange}),i.createElement(f.a,{gap:"gap.small"},i.createElement(te.a,{content:n.localize("manageCategories"),onClick:n.onManageCategoriesClick}),i.createElement(te.a,{className:n.props.dir===ie.Rtl?"rtl-right-margin-medium":"",icon:i.createElement(be.AddIcon,null),primary:!0,content:i.createElement(b.a,{className:n.props.dir===ie.Rtl?"rtl-right-margin-small":"",content:n.localize("createEvent")}),onClick:n.onCreateEventsClick}))))),n.state.isLoading?i.createElement(ne.a,{className:"loader"}):i.createElement("div",{key:n.state.infiniteScrollKey,className:"manage-events-scroll-area"},i.createElement(Re.a,{pageStart:0,loadMore:n.getEvents,hasMore:n.state.loadMoreEvents,initialLoad:!1,loader:i.createElement("div",null,i.createElement(ne.a,null)),useWindow:!1},n.renderEvents())))},n.localize=n.props.t,n.teamId="",n.timeout=null,n.draftEventsCount=-1,n.completedEventsCount=-1,n.activeEventsCount=-1,n.eventsScrollAreaRef=null,n.state={activeTabIndex:1,draftEvents:[],activeEvents:[],completedEvents:[],isLoading:!0,infiniteScrollKey:0,loadMoreEvents:!1,isInitialLoadComplete:!1,isMobileView:!1,notification:{id:0,message:"",type:nt.None},searchText:"",isMobileSearchBoxOpen:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onScreenSizeChange.bind(this)),this.onScreenSizeChange()}},{key:"onScreenSizeChange",value:function(){this.setState({isMobileView:window.innerWidth<=I.maxWidthForMobileView})}},{key:"renderEvents",value:function(){var e,t=this,a=[];if(0===this.state.activeTabIndex?a=Object(oe.a)(this.state.draftEvents):2===this.state.activeTabIndex?a=Object(oe.a)(this.state.completedEvents):1===this.state.activeTabIndex&&(a=Object(oe.a)(this.state.activeEvents)),(null===(e=a)||void 0===e?void 0:e.length)>0){if(this.state.isMobileView){var n=a.map((function(e,a){return{key:"event-".concat(a),content:i.createElement("div",{className:"manage-events-list-item-container"},i.createElement(f.a,{space:"between"},i.createElement(f.a,{column:!0},i.createElement(b.a,{content:e.name,weight:"bold",className:"list-header"}),i.createElement(f.a,{className:"list-elements",vAlign:"center"},i.createElement(b.a,{className:"category-name",content:e.categoryName,weight:"semibold"}),i.createElement(b.a,{content:"|",weight:"semibold",className:"divider"}),i.createElement(b.a,{content:e.type===_.InPerson?e.venue:t.localize("teamsMeeting"),weight:"semibold"})),i.createElement(b.a,{className:"list-elements",content:t.formatEventDateAndTime(e)}),i.createElement(b.a,{className:"list-elements",content:"".concat(t.localize("noOfRegistrations"),": ").concat(e.registeredAttendeesCount,"/").concat(e.maximumNumberOfParticipants)})),i.createElement(f.a.Item,{push:!0},e.status===F.Cancelled?i.createElement(te.a,{disabled:!0,text:!0,iconOnly:!0,icon:i.createElement(be.MoreIcon,null)}):i.createElement(Ot,{eventDetails:e,onCancelEvent:t.onCancelEvent,onCloseRegistration:t.onCloseRegistration,onEditEvent:t.onEditEvent,onExportDetails:t.onExportDetails,onSendReminder:t.onSendReminder,onDeleteDraftEvent:t.onDeleteDraftEvent,dir:t.props.dir}))))}}));return i.createElement(xt.a,{className:"manage-events-mobile-list-view",items:n})}var r=a.map((function(e){var a=t.getEventType(e),n=t.formatEventDateAndTime(e);return{key:"row-".concat(e.eventId),items:[{content:i.createElement(b.a,{error:e.status===F.Cancelled,content:e.name+(e.status===F.Cancelled?" (".concat(t.localize("cancelledStatus"),")"):""),weight:"bold"}),truncateContent:!0,title:e.name},{content:n,truncateContent:!0,title:n,design:{minWidth:"17vw",maxWidth:"17vw"}},{content:a,truncateContent:!0,title:a,design:{minWidth:"17vw",maxWidth:"17vw"}},{content:"".concat(e.registeredAttendeesCount,"/").concat(e.maximumNumberOfParticipants),design:{minWidth:"12vw",maxWidth:"12vw"}},{content:e.categoryName,truncateContent:!0,title:e.categoryName,design:{minWidth:"15vw",maxWidth:"15vw"}},{content:e.status===F.Cancelled?i.createElement(te.a,{disabled:!0,text:!0,iconOnly:!0,icon:i.createElement(be.MoreIcon,null)}):i.createElement(Ot,{eventDetails:e,onCancelEvent:t.onCancelEvent,onCloseRegistration:t.onCloseRegistration,onEditEvent:t.onEditEvent,onExportDetails:t.onExportDetails,onSendReminder:t.onSendReminder,onDeleteDraftEvent:t.onDeleteDraftEvent,dir:t.props.dir}),design:{minWidth:"5vw",maxWidth:"5vw"}}]}}));return i.createElement(Dt.a,{className:"manage-events-table",header:this.getEventsTableHeader(),rows:r})}return i.createElement(Ke,{message:this.localize("eventsNotAvailable")})}},{key:"render",value:function(){return i.createElement(Ie.a,{dir:this.props.dir},i.createElement("div",{className:"container-div"},this.state.isMobileView?this.renderMobileView():this.renderDesktopView(),i.createElement(dt,{dir:this.props.dir,notification:this.state.notification})))}}]),a}(i.Component)),Ft=Object(U.a)()(ye(jt)),Mt=a(78),Bt=a(173),Rt=a(240),Ut=a(346),Vt=a.n(Ut),_t=a(915),Wt=a(917),Kt=a(30),Gt=a(922),Ht={themeDarker:"#82c7ff",themeDark:"#6cb8f6",themeDarkAlt:"#3aa0f3",themePrimary:"#2899f5",themeSecondary:"#0078d4",themeTertiary:"#235a85",themeLight:"#004c87",themeLighter:"#043862",themeLighterAlt:"#092c47",black:"#ffffff",neutralDark:"#faf9f8",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralSecondary:"#a19f9d",neutralSecondaryAlt:"#979693",neutralTertiary:"#797775",neutralTertiaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralQuaternaryAlt:"#323130",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",white:"#1b1a19",redDark:"#F1707B"},Qt=Object(Kt.i)({palette:Ht,semanticColors:{buttonText:Ht.black,buttonTextPressed:Ht.neutralDark,buttonTextHovered:Ht.neutralPrimary,disabledBackground:Ht.neutralQuaternaryAlt,inputBackgroundChecked:Ht.themePrimary,menuBackground:Ht.neutralLighter,menuItemBackgroundHovered:Ht.neutralQuaternaryAlt,menuItemBackgroundPressed:Ht.neutralQuaternary,menuDivider:Ht.neutralTertiaryAlt,menuIcon:Ht.themeDarkAlt,menuHeader:Ht.black,menuItemText:Ht.neutralPrimary,menuItemTextHovered:Ht.neutralDark},isInverted:!0}),Jt={settings:{theme:Qt},scopedSettings:{Card:{styles:{root:{background:Qt.palette.neutralLighter}}},DatePicker:{styles:function(e){var t=e.disabled,a=function(){return{color:Qt.palette.neutralPrimary,backgroundColor:Qt.palette.neutralQuaternary}};return{callout:{backgroundColor:Qt.semanticColors.bodyBackground,color:Qt.palette.neutralPrimary,selectors:Object(se.a)(Object(se.a)({".ms-DatePicker-day--infocus":{color:Qt.palette.neutralPrimary},".ms-DatePicker-currentDecade":{color:Qt.palette.neutralPrimary},".ms-DatePicker-day--outfocus":{color:Qt.palette.neutralSecondary},".ms-DatePicker-monthAndYear":{color:Qt.palette.neutralPrimary},".ms-DatePicker-weekday":{color:Qt.palette.neutralSecondary},".ms-DatePicker-monthOption":{color:Qt.palette.neutralPrimary},".ms-DatePicker-currentYear":{color:Qt.palette.neutralPrimary},".ms-DatePicker-prevMonth":{color:Qt.palette.neutralPrimary},".ms-DatePicker-nextMonth":{color:Qt.palette.neutralPrimary},".ms-DatePicker-prevYear":{color:Qt.palette.neutralPrimary},".ms-DatePicker-nextYear":{color:Qt.palette.neutralPrimary},".ms-DatePicker-prevDecade":{color:Qt.palette.neutralPrimary},".ms-DatePicker-nextDecade":{color:Qt.palette.neutralPrimary},".ms-DatePicker-goToday":{color:Qt.palette.neutralPrimary},".ms-DatePicker-goToday[disabled]":{display:"none"},".ms-DatePicker-yearOption":{color:Qt.palette.neutralPrimary},".ms-DatePicker-yearOption--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-monthOption--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-day--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-nextDecade--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-prevDecade--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-prevYear--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-nextYear--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-prevMonth--disabled":{color:Qt.palette.neutralSecondary},".ms-DatePicker-nextMonth--disabled":{color:Qt.palette.neutralSecondary}},{".ms-DatePicker-day-button.ms-DatePicker-day--today":{backgroundColor:Qt.palette.themePrimary,color:Qt.palette.neutralPrimary},".ms-DatePicker-day-button.ms-DatePicker-day--today:active":{backgroundColor:Qt.palette.themePrimary},".ms-DatePicker-day-button.ms-DatePicker-day--today:hover":{color:Qt.palette.neutralPrimary},".ms-DatePicker-day--highlighted":{backgroundColor:Qt.palette.themeSecondary,color:Qt.palette.neutralPrimary},".ms-DatePicker-day--highlighted > .ms-DatePicker-day-button":{backgroundColor:Qt.palette.themePrimary},".ms-DatePicker-day--highlighted > .ms-DatePicker-day--today":{color:Qt.palette.neutralPrimary}}),{".ms-DatePicker-day--highlighted:hover":{backgroundColor:Qt.semanticColors.listItemBackgroundChecked,color:Qt.palette.neutralPrimary},".ms-DatePicker-day--highlighted > .ms-DatePicker-day-button:hover":{color:Qt.palette.neutralPrimary},".ms-DatePicker-day--infocus:hover":Object(se.a)({},a()),".ms-DatePicker-currentDecade:hover":{color:Qt.palette.neutralPrimary},".ms-DatePicker-day--outfocus:hover":Object(se.a)({},a()),".ms-DatePicker-monthAndYear:hover":{color:Qt.palette.neutralPrimary},".ms-DatePicker-weekday:hover":{color:Qt.palette.neutralPrimary},".ms-DatePicker-monthOption:hover":Object(se.a)({},a()),".ms-DatePicker-header > .ms-DatePicker-currentYear:hover":{color:Qt.palette.neutralPrimary},".ms-DatePicker-prevMonth:hover":Object(se.a)({},a()),".ms-DatePicker-nextMonth:hover":Object(se.a)({},a()),".ms-DatePicker-prevYear:hover":Object(se.a)({},a()),".ms-DatePicker-nextYear:hover":Object(se.a)({},a()),".ms-DatePicker-goToday:hover":{color:Qt.palette.neutralPrimary,backgroundColor:Qt.palette.themeSecondary},".ms-DatePicker-yearOption:hover":Object(se.a)({},a()),".ms-DatePicker-prevDecade:hover":Object(se.a)({},a()),".ms-DatePicker-nextDecade:hover":Object(se.a)({},a())})},icon:[{color:Qt.palette.neutralPrimary},t&&{color:Qt.semanticColors.disabledBodyText}],root:[t&&{color:Qt.semanticColors.disabledBodyText}]}}},DetailsList:{styles:{headerWrapper:{selectors:{".ms-DetailsHeader":{borderColor:Qt.palette.neutralQuaternary}}}}},ActionButton:{styles:{root:{backgroundColor:Qt.palette.white},rootDisabled:{backgroundColor:Qt.palette.neutralLighter},rootHovered:{backgroundColor:Qt.palette.neutralLight},rootPressed:{backgroundColor:Qt.palette.neutralQuaternaryAlt}}},DetailsRow:{styles:{root:{selectors:{":hover":{background:Qt.palette.neutralLighter}},borderColor:Qt.palette.neutralQuaternaryAlt}}},Modal:{styles:{main:{backgroundColor:Qt.palette.neutralLighter}}},Overlay:{styles:{root:{background:Qt.palette.blackTranslucent40}}},VerticalDivider:{styles:{divider:{backgroundColor:Qt.palette.neutralQuaternaryAlt},wrapper:{Backgroundcolor:Qt.palette.green}}},DocumentCard:{styles:{root:{border:"1px solid ".concat(Qt.palette.neutralQuaternaryAlt),selectors:{".ms-DocumentCardPreview":{borderRight:"1px solid ".concat(Qt.palette.neutralQuaternaryAlt)}}}}},DocumentCardPreview:{styles:{root:{borderBottom:"1px solid ".concat(Qt.palette.neutralQuaternaryAlt),borderRight:"1px solid ".concat(Qt.palette.neutralQuaternaryAlt)}}},Panel:{styles:{main:{backgroundColor:Qt.palette.neutralLighter},closeButton:{color:Qt.palette.neutralSecondary,selectors:{":hover":{color:Qt.palette.neutralPrimary}}}}},PeoplePickerItem:{styles:function(e){var t=e.selected;return{root:[{background:Qt.palette.neutralQuaternaryAlt,selectors:{":hover":{background:Qt.palette.neutralQuaternary}}},t&&{backgroundColor:Qt.palette.themeSecondary,selectors:{":hover":{background:Qt.palette.themeSecondary}}}],removeButton:[{background:Qt.palette.neutralQuaternaryAlt,color:Qt.palette.neutralDark,selectors:{":hover":{background:Qt.palette.neutralQuaternary,color:Qt.palette.black}}},t&&{background:Qt.palette.themeSecondary,selectors:{":hover":{background:Qt.palette.themeDark},":active":{color:Qt.palette.black}}}],subComponentStyles:{persona:{primaryText:[{color:Qt.palette.neutralPrimary},t&&{color:Qt.palette.black,selectors:{":hover":{color:Qt.palette.black}}}]}}}}},PersonaCoin:{styles:function(e){return{initials:{color:e.showUnknownPersonaCoin?Qt.palette.redDark:Qt.palette.black}}}},Separator:{styles:{root:{selectors:{":before":{backgroundColor:Qt.palette.neutralQuaternaryAlt},":after":{backgroundColor:Qt.palette.neutralQuaternaryAlt}}}}},SpinButton:{styles:{inputTextSelected:{color:Qt.palette.black,background:Qt.palette.themePrimary}}}}};Object(Gt.a)(Jt.settings.theme);var Yt={settings:{theme:Object(Kt.i)({})},scopedSettings:{}};Object(Gt.a)(Yt.settings.theme);a(845);Object(He.a)();var qt=function(e){var t,a="",n=e.theme;n===at.dark||n===at.contrast?(a="dark-datepicker",t=Jt):(a="default-datepicker",t=Yt);var r=Object(i.useState)(e.selectedDate),s=Object(Oe.a)(r,2),o=s[0],c=s[1],l=Object(i.useState)(e.minDate),u=Object(Oe.a)(l,2),d=u[0],m=u[1];i.useEffect((function(){c(e.selectedDate)}),[e.selectedDate]),i.useEffect((function(){m(e.minDate)}),[e.minDate]);return i.createElement(i.Fragment,null,i.createElement(f.a,{gap:"gap.small"},i.createElement(Ie.a,{className:"full-width",dir:"ltr"},i.createElement(Wt.a,t,i.createElement(_t.a,{className:a,label:"",showMonthPickerAsOverlay:!0,minDate:d,isMonthPickerVisible:!0,value:o,onSelectDate:function(t){var a=R()(t).set("hour",R()().hour()).set("minute",R()().minute()).set("second",R()().second());e.onDateSelect(a.toDate()),c(a.toDate())},disabled:e.disableSelectionForPastDate})))))},Zt=(a(846),function(e){var t=Object(Ze.a)().t,a=Object(i.useState)(!1),n=Object(Oe.a)(a,2),r=n[0],o=n[1],c=s.a.useState(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0")),l=Object(Oe.a)(c,2),u=l[0],d=l[1],m=s.a.useState(e.hours.toString().padStart(2,"0")),p=Object(Oe.a)(m,2),v=p[0],g=p[1],h=s.a.useState(e.minutes.toString().padStart(2,"0")),E=Object(Oe.a)(h,2),y=E[0],C=E[1],S=s.a.useState(e.minHours),k=Object(Oe.a)(S,2),w=k[0],x=k[1],D=s.a.useState(e.minMinutes),O=Object(Oe.a)(D,2),T=(O[0],O[1]),I=[],N=[];s.a.useEffect((function(){g(e.hours.toString().padStart(2,"0")),d(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0"))}),[e.hours]),s.a.useEffect((function(){C(e.minutes.toString().padStart(2,"0")),d(e.hours.toString().padStart(2,"0")+":"+e.minutes.toString().padStart(2,"0"))}),[e.minutes]),s.a.useEffect((function(){x(e.minHours)}),[e.minHours]),s.a.useEffect((function(){T(e.minMinutes)}),[e.minMinutes]);for(var L=w||0;L<24;L++)I.push(L.toString().padStart(2,"0"));for(L=0;L<60;L++)N.push(L.toString().padStart(2,"0"));var P={onAdd:function(e){return e&&g(e),""}},A={onAdd:function(e){return e&&C(e),""}},z=s.a.createElement("div",{className:"timepicker-popup-style"},s.a.createElement(f.a,{gap:"gap.small"},s.a.createElement(f.a.Item,{size:"size.half"},s.a.createElement(b.a,{size:e.dir===ie.Rtl?"medium":"small",content:t("hourPlaceholder")})),s.a.createElement(f.a.Item,{size:"size.half",className:e.dir===ie.Rtl?"rtl-right-margin-large":""},s.a.createElement(b.a,{size:e.dir===ie.Rtl?"medium":"small",content:t("minutePlaceholder")}))),s.a.createElement(f.a,{gap:"gap.small",styles:{marginTop:"0.5rem"}},s.a.createElement(f.a.Item,null,s.a.createElement(Bt.a,{className:"timepicker-dropdown",items:I,value:v,placeholder:t("hourPlaceholder"),getA11ySelectionMessage:P})),s.a.createElement(f.a.Item,null,s.a.createElement(Bt.a,{className:e.dir===ie.Rtl?"timepicker-dropdown rtl-right-margin-small":"timepicker-dropdown",value:y,items:N,placeholder:t("minutePlaceholder"),getA11ySelectionMessage:A}))));return s.a.createElement(Qe.a,{open:r,trapFocus:!0,onOpenChange:function(t,a){var n=a.open;o(n),n||(d(v+":"+y),e.onPickerClose(parseInt(v),parseInt(y)))},trigger:s.a.createElement(ze.a,{className:e.dir===ie.Rtl?"rtl-left-margin-small":"",disabled:e.isDisabled,fluid:!0,value:u,icon:s.a.createElement(re.a,{iconName:"Clock"}),iconPosition:e.dir===ie.Rtl?"start":"end"}),content:z})});Zt.defaultProps={hours:0,minutes:0};var $t=a(913),Xt=(a(847),function(e){var t=s.a.useState(),a=Object(Oe.a)(t,2),n=a[0],r=a[1],i=s.a.useState(1),o=Object(Oe.a)(i,2),c=o[0],l=o[1];return s.a.useEffect((function(){var t=at.colorCells.find((function(t){return t.color===e.selectedColor}));r(null===t||void 0===t?void 0:t.id),l(c+1)}),[e.selectedColor]),s.a.createElement("div",{className:"color-picker",key:c},s.a.createElement($t.a,{columnCount:5,cellShape:"circle",colorCells:at.colorCells,selectedId:n,onColorChanged:e.onColorChange}))}),ea=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.inputReference=void 0,n.teamId=void 0,n.timeZone=void 0,n.update=function(){n.setState({screenWidth:window.innerWidth})},n.checkIfSaveAsDraftAllowed=function(){var e={isPhotoValid:!0,isColorValid:!0,isNameValid:!0,isDescriptionValid:!0,isEventTypeValid:!0,isEventCategoryValid:!0,isVenueValid:!0,isMaxNoofPartipantsValid:!0,isMeetingLinkValid:!0};return(""==n.state.eventDetails.name||n.state.eventDetails.name.length>at.eventNameMaxLength)&&(e.isNameValid=!1),n.setState({isPhotoValid:e.isPhotoValid,isColorValid:e.isColorValid,isNameValid:e.isNameValid,isDescriptionValid:e.isDescriptionValid,isEventTypeValid:e.isEventTypeValid,isEventCategoryValid:e.isEventCategoryValid,isVenueValid:e.isVenueValid,isMaxNoofParticipantsValid:e.isMaxNoofPartipantsValid,isMeetingLinkValid:e.isMeetingLinkValid}),!(!(e.isPhotoValid&&e.isColorValid&&e.isNameValid&&e.isDescriptionValid&&e.isEventTypeValid&&e.isEventCategoryValid&&e.isVenueValid&&e.isMaxNoofPartipantsValid&&e.isMeetingLinkValid)||n.state.isEventNameExisting)},n.checkIfNextAllowed=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={isTimeValid:!0,isPhotoValid:!0,isColorValid:!0,isNameValid:!0,isDescriptionValid:!0,isEventTypeValid:!0,isEventCategoryValid:!0,isVenueValid:!0,isMaxNoofPartipantsValid:!0,isMeetingLinkValid:!0},n.state.eventDetails.photo||n.state.eventDetails.selectedColor||(t.isPhotoValid=!1,t.isColorValid=!1),(""==n.state.eventDetails.name.trim()||n.state.eventDetails.name.length>at.eventNameMaxLength)&&(t.isNameValid=!1),!1,(""==n.state.eventDetails.description.trim()||n.state.eventDetails.description.length>at.eventDescriptionMaxLength)&&(t.isDescriptionValid=!1),n.state.eventDetails.type||(t.isEventTypeValid=!1),n.state.eventDetails.categoryId||(t.isEventCategoryValid=!1),n.state.eventDetails.type===_.InPerson&&""==n.state.eventDetails.venue&&(t.isVenueValid=!1),n.state.eventDetails.maximumNumberOfParticipants||(t.isMaxNoofPartipantsValid=!1),n.state.eventDetails.type!==_.LiveEvent||""!=n.state.eventDetails.meetingLink&&n.state.eventDetails.meetingLink.match(at.validUrlRegExp)||(t.isMeetingLinkValid=!1),n.checkEventAlreadyStarted()&&(!n.state.eventDetails.startTime||!n.state.eventDetails.endTime||n.state.eventDetails.startTime>=n.state.eventDetails.endTime)&&(t.isTimeValid=!1),n.setState({isPhotoValid:t.isPhotoValid,isColorValid:t.isColorValid,isNameValid:t.isNameValid,isDescriptionValid:t.isDescriptionValid,isEventTypeValid:t.isEventTypeValid,isEventCategoryValid:t.isEventCategoryValid,isVenueValid:t.isVenueValid,isMaxNoofParticipantsValid:t.isMaxNoofPartipantsValid,isMeetingLinkValid:t.isMeetingLinkValid,isTimeValid:t.isTimeValid,isEventNameExisting:!1,isValidatingStep1:!1}),!(t.isPhotoValid&&t.isColorValid&&t.isNameValid&&t.isDescriptionValid&&t.isEventTypeValid&&t.isEventCategoryValid&&t.isVenueValid&&t.isMaxNoofPartipantsValid&&t.isMeetingLinkValid&&t.isTimeValid)||n.state.isEventNameExisting){e.next=16;break}return e.abrupt("return",!0);case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e)}))),n.checkEventAlreadyStarted=function(){return!(n.props.eventPageState.isEdit&&Vt.a.utc(n.state.eventDetails.startDate).local().toDate()<new Date)},n.nextBtnClick=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isValidatingStep1:!0}),e.next=3,n.checkIfNextAllowed();case 3:e.sent&&((t=Object(se.a)({},n.props.eventPageState)).eventDetails=n.state.eventDetails,t.selectedCategory=n.state.selectedCategory,t.selectedEvent=n.state.selectedEventType,t.categories=n.state.categories,n.props.navigateToPage(2,t));case 5:case"end":return e.stop()}}),e)}))),n.setStartDate=function(e){var t=n.state.eventDetails;t.startDate=e,t.endDate=e,n.setState({eventDetails:t})},n.setEndDate=function(e){var t=n.state.eventDetails;t.endDate=e,n.setState({eventDetails:t})},n.getNameError=function(){return n.state.isNameValid?n.state.eventDetails.name.length>at.eventNameMaxLength?i.createElement(b.a,{"data-testid":"event_name_max_error",content:n.localize("eventNameMaxCharError"),error:!0}):n.state.isEventNameExisting?i.createElement(b.a,{content:n.localize("eventNameAlreadyExists"),error:!0}):i.createElement(i.Fragment,null):i.createElement(b.a,{"data-testid":"event_name_req_error",content:n.localize("required"),error:!0})},n.getMeetingLinkError=function(){return n.state.isMeetingLinkValid?i.createElement(i.Fragment,null):i.createElement(b.a,{"data-testid":"event_link_req_error",content:n.localize("validUrlErrorMessage"),error:!0})},n.getDescriptionError=function(){return n.state.isDescriptionValid?n.state.eventDetails.description.length>at.eventDescriptionMaxLength?i.createElement(b.a,{"data-testid":"event_desc_max_error",content:n.localize("eventDescriptionMaxCharError"),error:!0}):i.createElement(i.Fragment,null):i.createElement(b.a,{"data-testid":"event_desc_req_error",content:n.localize("required"),error:!0})},n.getVenueError=function(){return n.state.isVenueValid?n.state.eventDetails.venue.length>at.eventVenueMaxLength?i.createElement(b.a,{"data-testid":"event_venue_max_error",content:n.localize("eventVenueMaxCharError"),error:!0}):i.createElement(i.Fragment,null):i.createElement(b.a,{"data-testid":"event_venue_req_error",content:n.localize("required"),error:!0,size:"medium"})},n.getEventTypeError=function(){return n.state.isEventTypeValid?i.createElement(b.a,{content:"",error:!0,size:"medium"}):i.createElement(b.a,{"data-testid":"event_type_error",content:n.localize("required"),error:!0})},n.getEventCategoryError=function(){return n.state.isEventCategoryValid?i.createElement(b.a,{content:"",error:!0,size:"medium"}):i.createElement(b.a,{"data-testid":"event_category_error",content:n.localize("required"),error:!0})},n.getPhotoError=function(){return n.state.isPhotoValid?n.state.isPhotoDimentionsValid?i.createElement(b.a,{content:"",error:!0,size:"medium"}):i.createElement(b.a,{content:n.localize("invalidImageDimensions"),error:!0}):i.createElement(b.a,{"data-testid":"event_photo_error",content:n.localize("required"),error:!0})},n.getMaximumNoofParticipantsError=function(){return n.state.isMaxNoofParticipantsValid?i.createElement(i.Fragment,null):i.createElement(b.a,{"data-testid":"event_max_req_error",content:n.localize("required"),error:!0})},n.onEventNameChange=function(e){n.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{name:e}),isNameValid:!0,isEventNameExisting:!1}}))},n.onEventDescriptionChange=function(e){n.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{description:e}),isDescriptionValid:!0}}))},n.onEventVenueChange=function(e){n.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{venue:e}),isVenueValid:!0}}))},n.onLiveEventUrlChange=function(e){n.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{meetingLink:e}),isMeetingLinkValid:!0}}))},n.onMaxNoOfParticipantsChange=function(e){n.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{maximumNumberOfParticipants:parseInt(e)}),isMaxNoofParticipantsValid:!0}}))},n.onStartTimeChange=function(e,t){n.setState((function(a){return{eventDetails:Object(se.a)(Object(se.a)({},a.eventDetails),{},{startTime:new Date((new Date).setHours(e,t)),endTime:void 0===n.state.eventDetails.endTime?new Date((new Date).setHours(e,t+15)):n.state.eventDetails.endTime})}}))},n.onEndTimeChange=function(e,t){n.setState((function(a){return{eventDetails:Object(se.a)(Object(se.a)({},a.eventDetails),{},{endTime:new Date((new Date).setHours(e,t))})}}))},n.handleUploadClick=function(e){n.inputReference.current.click()},n.onColorChange=function(e,t){n.setState((function(e){return{eventDetails:Object(se.a)(Object(se.a)({},e.eventDetails),{},{selectedColor:t,photo:""}),inputKey:n.state.inputKey+1,isPhotoDimentionsValid:!0,isPhotoValid:!0}}))},n.uploadImage=function(){var e=Object(h.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({imageUploadLoader:!0}),e.next=3,ce(t,n.teamId);case 3:(a=e.sent)&&a.status===r.OK&&a.data?n.setState((function(e){return{eventDetails:Object(se.a)(Object(se.a)({},e.eventDetails),{},{photo:a.data,selectedColor:""}),imageUploadLoader:!1}})):n.setState({imageUploadLoader:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleChange=function(e){var t=e.target.files[0];if(t){var a=!0,r=new Image;r.src=window.URL.createObjectURL(t),r.onload=function(){if(r.width<850||r.height<290||r.width>900||r.height>310)a=!1;else{var e=new FormData;e.append("fileInfo",t,t.name),n.uploadImage(e)}n.setState({isPhotoDimentionsValid:a})}}},n.checkEventName=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),n.saveEventAsDraft=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.checkIfSaveAsDraftAllowed()){e.next=12;break}return n.setState({isLoading:!0}),(t=Object(se.a)({},n.props.eventPageState)).eventDetails=n.state.eventDetails,t.selectedCategory=n.state.selectedCategory,t.selectedEvent=n.state.selectedEventType,t.categories=n.state.categories,e.next=10,fe(t,n.teamId);case 10:e.sent?n.props.microsoftTeams.tasks.submitTask({isSuccess:!0,isDraft:!0}):n.setState({isLoading:!1});case 12:case"end":return e.stop()}}),e)}))),n.localize=n.props.t;var s,o=(s=n.localize,at.eventType.map((function(e){switch(e.id){case _.InPerson:return e.name=s("inPersonEvent"),e;case _.Teams:return e.name=s("teamsEvent"),e;case _.LiveEvent:return e.name=s("liveEvent"),e;default:return e}})));window.addEventListener("resize",n.update),n.inputReference=i.createRef();var c=new Date;return n.teamId="",n.timeZone=Vt.a.tz.guess(),n.state={imageUploadLoader:!1,inputKey:1,isLoading:!1,categories:n.props.eventPageState.categories.length>0?n.props.eventPageState.categories:new Array,theme:"",eventTypes:o,screenWidth:window.innerWidth,projectStartDate:c.setDate(c.getDate()+1),isPhotoValid:!0,isColorValid:!0,isEventNameExisting:!1,isPhotoDimentionsValid:!0,isNameValid:!0,isDescriptionValid:!0,isTimeValid:!0,isVenueValid:!0,isMeetingLinkValid:!0,isEventTypeValid:!0,isEventCategoryValid:!0,isMaxNoofParticipantsValid:!0,isValidatingStep1:!1,selectedEventType:void 0===n.props.eventPageState.eventDetails.type?{key:_.Teams.toString(),header:o.find((function(e){return e.id===_.Teams})).name}:{key:o.find((function(e){return e.id===n.props.eventPageState.eventDetails.type})).id.toString(),header:o.find((function(e){return e.id===n.props.eventPageState.eventDetails.type})).name},selectedCategory:n.props.eventPageState.selectedCategory,eventDetails:Object(se.a)({},n.props.eventPageState.eventDetails)},n}return Object(u.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.eventPageState.categories!==this.props.eventPageState.categories&&this.setState({categories:e.eventPageState.categories}),e.eventPageState.eventDetails!==this.props.eventPageState.eventDetails&&this.setState({eventDetails:Object(se.a)({},e.eventPageState.eventDetails)}),e.eventPageState.selectedCategory!==this.props.eventPageState.selectedCategory&&this.setState({selectedCategory:e.eventPageState.selectedCategory}),e.teamsContext&&e.teamsContext!==this.props.teamsContext&&(this.setState({theme:e.teamsContext.theme}),this.teamId=e.teamsContext.teamId)}},{key:"render",value:function(){for(var e,t,a,n,r,s=this,o={onAdd:function(e){return s.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{type:e.key}),isEventTypeValid:!0,selectedEventType:e}})),""}},c=new Array,l=0;l<this.state.categories.length;l++)c.push({key:this.state.categories[l].id.toString(),header:this.state.categories[l].name});var u=new Date;return u.setDate(u.getDate()+1),i.createElement(i.Fragment,null,i.createElement("div",{className:"page-content"},i.createElement(f.a,{gap:"gap.smaller"},i.createElement(b.a,{size:"large",content:this.localize("eventDetailsStep1")})),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top",vAlign:"center"},i.createElement(b.a,{className:"form-label margin-right",content:this.localize("eventPhotoStep1")}),i.createElement(be.ExclamationCircleIcon,{title:this.localize("imageInfoIcon"),size:"small"}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getPhotoError())),this.state.eventDetails.photo&&i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between",vAlign:"end"},i.createElement(Mt.a,{className:"event-image-color",fluid:!0,src:this.state.eventDetails.photo})),this.state.eventDetails.selectedColor&&i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between",vAlign:"end"},i.createElement("div",{className:"event-image-color",style:{backgroundColor:this.state.eventDetails.selectedColor}},i.createElement(f.a,{className:"event-image-color",hAlign:"center",vAlign:"center"},i.createElement(b.a,{className:"event-color-text",size:"large",weight:"semibold",content:this.state.eventDetails.name})))),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between",vAlign:"center"},i.createElement(f.a.Item,null,i.createElement(i.Fragment,null,i.createElement(te.a,{disabled:this.state.imageUploadLoader,loading:this.state.imageUploadLoader,onClick:this.handleUploadClick,size:"medium",icon:i.createElement(be.FilesUploadIcon,{className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""}),content:this.state.eventDetails.photo&&this.state.eventDetails.photo.length?this.localize("changePhotoStep1"):this.localize("uploadPhotoStep1"),iconPosition:"before"}),i.createElement("input",{type:"file",ref:this.inputReference,onChange:this.handleChange,style:{display:"none"},key:this.state.inputKey}),i.createElement(b.a,{className:this.props.dir===ie.Rtl?"form-label rtl-left-margin-small":"form-label",content:this.localize("orLabelForImageOrColor")}))),i.createElement(f.a.Item,null,i.createElement("div",null,i.createElement(Xt,{onColorChange:this.onColorChange,selectedColor:this.state.eventDetails.selectedColor})))),i.createElement(f.a,{className:"margin-top",gap:"gap.smaller"},i.createElement(b.a,{className:"form-label",content:this.localize("eventNameStep1")}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getNameError())),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(ze.a,{"data-testid":"event_name_input",maxLength:at.eventNameMaxLength,fluid:!0,placeholder:this.localize("eventNamePlaceholderStep1"),value:this.state.eventDetails.name,onChange:function(e){return s.onEventNameChange(e.target.value)}})),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(f.a,null,i.createElement(b.a,{className:"form-label",content:this.localize("eventTypeStep1")}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getEventTypeError()))),i.createElement(f.a.Item,{size:"size.half"},i.createElement(f.a,null,i.createElement(b.a,{className:"form-label",content:this.localize("category")}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getEventCategoryError())))),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(Bt.a,{className:this.props.dir===ie.Rtl?"dropdown-flex-half rtl-left-margin-small":"dropdown-flex-half",fluid:!0,items:this.state.eventTypes.map((function(e){return{key:e.id,header:e.name}})),value:this.state.selectedEventType,placeholder:this.localize("selectEventTypePlaceholder"),getA11ySelectionMessage:o,"data-testid":"event_type_dropdown"})),i.createElement(f.a.Item,{size:"size.half"},i.createElement(Bt.a,{className:"dropdown-flex-half",fluid:!0,onChange:function(e,t){var a;a=t.value,s.setState((function(e){return{eventDetails:Object(se.a)(Object(se.a)({},e.eventDetails),{},{categoryId:a.key}),isEventCategoryValid:!0,selectedCategory:a}}))},value:this.state.selectedCategory,items:c,placeholder:this.localize("selectCategoryPlaceholder"),"data-testid":"event_category_dropdown"}))),this.state.eventDetails.type===_.LiveEvent&&i.createElement(i.Fragment,null,i.createElement(f.a,{className:"margin-top",gap:"gap.smaller"},i.createElement(b.a,{className:"form-label",content:this.localize("liveEventUrlStep1")}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getMeetingLinkError())),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(ze.a,{fluid:!0,value:this.state.eventDetails.meetingLink,placeholder:this.localize("liveEventUrlPlaceholder"),onChange:function(e){return s.onLiveEventUrlChange(e.target.value)},"data-testid":"event_link_input"}))),this.state.eventDetails.type===_.InPerson&&i.createElement(i.Fragment,null,i.createElement(f.a,{className:"margin-top",gap:"gap.smaller"},i.createElement(b.a,{className:"form-label",content:this.localize("venue")}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getVenueError())),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(ze.a,{maxLength:at.eventVenueMaxLength,value:this.state.eventDetails.venue,onChange:function(e){return s.onEventVenueChange(e.target.value)},fluid:!0,placeholder:this.localize("venuePlaceholder"),"data-testid":"event_venue_input"}))),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(b.a,{className:"form-label",content:this.localize("eventDescriptionStep1")}),i.createElement(f.a.Item,{push:!0,grow:this.props.dir===ie.Rtl},this.getDescriptionError())),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(Rt.a,{maxLength:at.eventDescriptionMaxLength,fluid:!0,placeholder:this.localize("eventDescriptionPlaceholder"),value:this.state.eventDetails.description,onChange:function(e){return s.onEventDescriptionChange(e.target.value)},"data-testid":"event_description_input"})),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(b.a,{title:this.timeZone,truncated:!0,className:"form-label",content:"".concat(this.localize("yourTimeZone"),": ").concat(this.timeZone)})),this.state.screenWidth>=600&&i.createElement(i.Fragment,null,i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.a.Item,{size:"size.half"},i.createElement("div",null,i.createElement(b.a,{className:"form-label",align:this.props.dir===ie.Rtl?"end":"start",content:"".concat(this.localize("startDateStep1"))}),i.createElement(f.a,{className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""},i.createElement(qt,{screenWidth:this.state.screenWidth,theme:this.state.theme,selectedDate:this.state.eventDetails.startDate,minDate:u,onDateSelect:this.setStartDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()})))),i.createElement(f.a.Item,{size:"size.half"},i.createElement("div",null,i.createElement(b.a,{className:"form-label",align:this.props.dir===ie.Rtl?"end":"start",content:"".concat(this.localize("endDateStep1"))}),i.createElement(qt,{screenWidth:this.state.screenWidth,theme:this.state.theme,minDate:this.state.eventDetails.endDate,selectedDate:this.state.eventDetails.endDate,onDateSelect:this.setEndDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()}))))),this.state.screenWidth<600&&i.createElement(i.Fragment,null,i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(b.a,{className:"form-label",content:this.localize("startDateStep1")})),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(qt,{screenWidth:this.state.screenWidth,theme:this.state.theme,selectedDate:this.state.eventDetails.startDate,minDate:u,onDateSelect:this.setStartDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()})),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(b.a,{className:"form-label",content:this.localize("endDateStep1")})),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(qt,{screenWidth:this.state.screenWidth,theme:this.state.theme,minDate:this.state.eventDetails.startDate,selectedDate:this.state.eventDetails.endDate,onDateSelect:this.setEndDate,disableSelectionForPastDate:!this.checkEventAlreadyStarted()}))),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(f.a,{gap:"gap.smaller"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(b.a,{className:"form-label",align:this.props.dir===ie.Rtl?"end":"start",content:this.localize("startTimeStep1")})),i.createElement(f.a.Item,{size:"size.half"},i.createElement(b.a,{className:"form-label",align:this.props.dir===ie.Rtl?"end":"start",content:this.localize("endTimeStep1")})))),i.createElement(f.a.Item,{size:"size.half"},i.createElement(f.a,null,i.createElement(b.a,{className:"form-label",align:this.props.dir===ie.Rtl?"end":"start",content:this.localize("maxParticipantsStep1")}),i.createElement(f.a.Item,{push:this.props.dir===ie.Ltr,grow:this.props.dir===ie.Rtl},this.getMaximumNoofParticipantsError())))),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.a.Item,{size:"size.half",className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""},i.createElement(f.a,{gap:"gap.smaller"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(Zt,{hours:null===(e=this.state.eventDetails.startTime)||void 0===e?void 0:e.getHours(),minutes:null===(t=this.state.eventDetails.startTime)||void 0===t?void 0:t.getMinutes(),isDisabled:!this.checkEventAlreadyStarted(),onPickerClose:this.onStartTimeChange,dir:this.props.dir})),i.createElement(f.a.Item,{size:"size.half"},i.createElement(Zt,{hours:null===(a=this.state.eventDetails.endTime)||void 0===a?void 0:a.getHours(),minutes:null===(n=this.state.eventDetails.endTime)||void 0===n?void 0:n.getMinutes(),onPickerClose:this.onEndTimeChange,minHours:null===(r=this.state.eventDetails.startTime)||void 0===r?void 0:r.getHours(),minMinutes:void 0,isDisabled:!this.checkEventAlreadyStarted(),dir:this.props.dir})))),i.createElement(f.a.Item,{size:"size.half",className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""},i.createElement(ze.a,{type:"number",min:1,fluid:!0,value:this.state.eventDetails.maximumNumberOfParticipants.toString(),onChange:function(e){return s.onMaxNoOfParticipantsChange(e.target.value)},"data-testid":"event_maxParticipants_input"})))),this.props.dir===ie.Ltr&&i.createElement(f.a,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},!this.state.isTimeValid&&i.createElement(b.a,{error:!0,content:this.localize("startAndEndTimeError")}),i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{weight:"bold",content:this.localize("step1Of3")})),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(te.a,{disabled:this.state.isLoading||this.state.isValidatingStep1,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"event_save_button"}),i.createElement(te.a,{"data-testid":"event_next_button",content:this.localize("nextButton"),loading:this.state.isValidatingStep1,disabled:this.state.isLoading||this.state.isValidatingStep1,primary:!0,onClick:this.nextBtnClick})),this.props.dir===ie.Rtl&&i.createElement(f.a,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{error:!0,content:this.state.isTimeValid?"":this.localize("startAndEndTimeError")})),i.createElement(b.a,{className:"rtl-left-margin-small",weight:"bold",content:this.localize("step1Of3")}),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(te.a,{className:"rtl-left-margin-small",disabled:this.state.isLoading||this.state.isValidatingStep1,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"event_save_button"}),i.createElement(te.a,{"data-testid":"event_next_button",content:this.localize("nextButton"),loading:this.state.isValidatingStep1,disabled:this.state.isLoading||this.state.isValidatingStep1,primary:!0,onClick:this.nextBtnClick})))}}]),a}(i.Component),ta=Object(U.a)()(ye(ea)),aa=function(e){var t=null,a=new Array,n=i.useState(new Array),r=Object(Oe.a)(n,2),s=r[0],o=r[1],c=i.useState(!0),l=Object(Oe.a)(c,2),u=l[0],d=l[1],m=i.useState(!1),p=Object(Oe.a)(m,2),v=p[0],f=p[1],E=i.useState(0),b=Object(Oe.a)(E,2),y=b[0],C=b[1],S=i.useState(void 0),k=Object(Oe.a)(S,2),w=k[0],x=k[1],D=function(){var e=Object(h.a)(g.a.mark((function e(t){var n,r,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.length||t.length){e.next=3;break}return o(a),e.abrupt("return");case 3:return n=new Array,e.next=6,G(t);case 6:if(200===(r=e.sent).status&&r.data)for(i=r.data,s=0;s<i.length;s++)i[s].displayName&&i[s].email&&n.push({header:i[s].displayName,content:i[s].email,id:i[s].id,email:i[s].email,isGroup:i[s].isGroup});a.length||(a=[].concat(n)),o(n),d(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O={onAdd:function(t){return e.onItemSelect(t),C(y+1),""}};return i.createElement(Bt.a,{search:!0,styles:{width:"100%"},fluid:!0,key:y,loading:u,loadingMessage:e.loadingMessage,items:s,value:w,onChange:function(e,t){t.value;x(void 0)},onSearchQueryChange:function(e,a){!function(e){t&&window.clearTimeout(t),u||d(!0),t=window.setTimeout(Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D(e);case 2:case"end":return t.stop()}}),t)}))),750)}(a.searchQuery)},onOpenChange:function(e,t){var a=t.open;t.value;a?(d(!0),D("")):o(new Array),f(a)},open:v,getA11ySelectionMessage:O,placeholder:e.placeholder,noResultsMessage:e.noResultMessage,"data-testid":"audience_dropdown_search"})},na=a(442),ra=a(443),ia=a(444),sa=a(419),oa=a(420),ca=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n,r,s;Object(l.a)(this,a),(s=t.call(this,e)).localize=void 0,s.teamId=void 0,s.nextBtnClick=function(){var e=Object(se.a)({},s.props.eventPageState);e.selectedUserGroups=s.state.selectedUsersAndGroups,e.selectedAudience=s.state.selectedAudienceType,e.eventDetails=s.state.eventDetails,e.eventDetails.selectedUserOrGroupListJSON=JSON.stringify(s.state.selectedUsersAndGroups),s.props.navigateToPage(3,e)},s.backBtnClick=function(){var e=Object(se.a)({},s.props.eventPageState);e.selectedUserGroups=s.state.selectedUsersAndGroups,e.selectedAudience=s.state.selectedAudienceType,e.eventDetails=s.state.eventDetails,e.eventDetails.selectedUserOrGroupListJSON=JSON.stringify(s.state.selectedUsersAndGroups),s.props.navigateToPage(1,e)},s.onToggleChange=function(e){var t=s.state.selectedUsersAndGroups;t[e].isMandatory=!t[e].isMandatory,s.setState({selectedUsersAndGroups:t})},s.deleteItem=function(e){var t=s.state.selectedUsersAndGroups;t.splice(e,1),s.setState({selectedUsersAndGroups:t})},s.renderMembers=function(){if(s.state.selectedUsersAndGroups&&s.state.selectedUsersAndGroups.length>0){var e=s.state.selectedUsersAndGroups.map((function(e,t){return{key:t,items:[{content:i.createElement(i.Fragment,null,i.createElement(b.a,{weight:"bold",content:e.displayName}),i.createElement("br",null),i.createElement(b.a,{size:"small",content:e.email})),title:e.displayName,truncateContent:!0},{content:i.createElement(i.Fragment,null,i.createElement(b.a,{content:s.localize("mandatoryToggleStep2")}),i.createElement(Ye.a,{className:s.props.dir===ie.Rtl?"rtl-toggle":"",onChange:function(){return s.onToggleChange(t)},checked:e.isMandatory,toggle:!0})),className:"mandatory-toggle-column"},{content:i.createElement(na.a,{className:"icon-hover",onClick:function(){return s.deleteItem(t)}}),className:"delete-button-column"}]}}));return i.createElement(Dt.a,{className:"selected-user-group-table",rows:e})}return i.createElement(f.a,{gap:"gap.small"},i.createElement(f.a.Item,null,i.createElement("div",{style:{position:"relative"}},i.createElement(ra.a,{outline:!0,color:"green"}))),i.createElement(f.a.Item,{grow:s.props.dir===ie.Ltr},i.createElement(f.a,{column:!0,gap:"gap.small",vAlign:"stretch",className:s.props.dir===ie.Rtl?"rtl-right-margin-medium rtl-direction":""},i.createElement("div",null,i.createElement(b.a,{weight:"bold",content:s.localize("noUserSelectedHeaderStep2")}),i.createElement("br",null),i.createElement(b.a,{size:"small",content:s.localize("noUserSelectedContentStep2")})))))},s.onAudienceTypeSelection={onAdd:function(e){return s.setState({selectedAudienceType:e}),""}},s.onUserOrGroupSelection=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={displayName:t.header,email:t.content,id:t.id,isGroup:t.isGroup,isMandatory:!0},n=s.state.selectedUsersAndGroups,n.find((function(e){return e.id===a.id}))||(n.push(a),s.setState({selectedUsersAndGroups:n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onAudienceChange=function(e){s.setState((function(t){return{eventDetails:Object(se.a)(Object(se.a)({},t.eventDetails),{},{audience:e.key}),selectedAudienceType:e}}))},s.onAutoRegisterToggleChange=function(){s.setState((function(e){return{eventDetails:Object(se.a)(Object(se.a)({},e.eventDetails),{},{isAutoRegister:!s.state.eventDetails.isAutoRegister})}}))},s.saveEventAsDraft=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.setState({isLoading:!0}),(t=Object(se.a)({},s.props.eventPageState)).selectedUserGroups=s.state.selectedUsersAndGroups,t.selectedAudience=s.state.selectedAudienceType,t.eventDetails=s.state.eventDetails,t.eventDetails.selectedUserOrGroupListJSON=JSON.stringify(s.state.selectedUsersAndGroups),e.next=8,fe(t,s.teamId);case 8:e.sent?x.tasks.submitTask({isSuccess:!0,isDraft:!0}):s.setState({isLoading:!1});case 10:case"end":return e.stop()}}),e)}))),s.onMandatoryAllClocked=function(){for(var e=Object(oe.a)(s.state.selectedUsersAndGroups),t=0;t<e.length;t++)e[t].isMandatory=!0;s.setState({selectedUsersAndGroups:e})},s.teamId="",s.localize=s.props.t;var o,c=(o=s.localize,at.audienceType.map((function(e){switch(e.id){case V.Public:return e.name=o("publicAudience"),e;case V.Private:return e.name=o("privateAudience"),e;default:return e}})));return s.state={isLoading:!1,selectedAudienceType:{key:null===(n=s.props.eventPageState.eventDetails.audience)||void 0===n?void 0:n.toString(),header:null===(r=c.find((function(e){return e.id===s.props.eventPageState.eventDetails.audience})))||void 0===r?void 0:r.name},selectedUsersAndGroups:s.props.eventPageState.selectedUserGroups.length>0?s.props.eventPageState.selectedUserGroups:new Array,eventDetails:s.props.eventPageState.eventDetails,audienceTypes:c},s}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;x.initialize(),x.getContext((function(t){e.teamId=t.teamId}))}},{key:"render",value:function(){var e=this;return i.createElement(i.Fragment,null,i.createElement("div",{className:"page-content"},i.createElement(f.a,{gap:"gap.smaller"},i.createElement(b.a,{size:"large",content:this.localize("audienceDetailsStep2")})),i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(f.a,{gap:"gap.smaller",vAlign:"center"},i.createElement(b.a,{className:this.props.dir===ie.Rtl?"rtl-left-margin-small form-label":"form-label",content:this.localize("audienceTypeStep2")}),i.createElement(ia.a,{outline:!0,title:this.localize("audienceTypeInfoIconTitle")})))),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(f.a.Item,{size:"size.half"},i.createElement(Bt.a,{fluid:!0,value:this.state.selectedAudienceType,items:this.state.audienceTypes.map((function(e){return{key:e.id,header:e.name}})),onChange:function(t,a){e.onAudienceChange(a.value)},"data-testid":"event_audience_dropdown"}))),this.state.eventDetails.audience===V.Private&&i.createElement(i.Fragment,null,i.createElement(f.a,{gap:"gap.smaller",className:"margin-top"},i.createElement(aa,{loadingMessage:this.localize("dropdownSearchLoadingMessage"),noResultMessage:this.localize("noResultFoundDropdownMessage"),placeholder:this.localize("startTypingDropdownSearch"),onItemSelect:this.onUserOrGroupSelection})),i.createElement(f.a,{gap:"gap.smaller",className:"input-label-margin-between"},i.createElement(Ye.a,{onChange:function(){return e.onAutoRegisterToggleChange()},checked:this.state.eventDetails.isAutoRegister,label:this.localize("autoRegisterCheckboxLabelStep2"),"data-testid":"auto_toggle"}),i.createElement(f.a.Item,{push:this.props.dir===ie.Ltr,grow:this.props.dir===ie.Rtl},i.createElement(te.a,{onClick:this.onMandatoryAllClocked,primary:!0,text:!0,content:this.localize("mandatoryAllButtonStep2"),disabled:0===this.state.selectedUsersAndGroups.filter((function(e){return!1===e.isMandatory})).length,"data-testid":"audience_mandatory_button",className:this.props.dir===ie.Rtl?"left-push":""}))),this.renderMembers())),this.props.dir===ie.Ltr&&i.createElement(f.a,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(te.a,{icon:i.createElement(sa.a,null),text:!0,content:this.localize("back"),onClick:this.backBtnClick,"data-testid":"back_button"}),i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{weight:"bold",content:this.localize("step2Of3")})),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(te.a,{disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_draft_button"}),i.createElement(te.a,{content:this.localize("nextButton"),disabled:this.state.isLoading||this.state.eventDetails.audience===V.Private&&0===this.state.selectedUsersAndGroups.length,primary:!0,onClick:this.nextBtnClick,"data-testid":"next_button"})),this.props.dir===ie.Rtl&&i.createElement(f.a,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.a.Item,{push:!0},i.createElement(te.a,{icon:i.createElement(oa.a,null),text:!0,content:i.createElement(b.a,{content:this.localize("back"),className:this.props.dir===ie.Rtl?"rtl-right-margin-small":""}),onClick:this.backBtnClick,"data-testid":"back_button"})),i.createElement(b.a,{className:"rtl-left-margin-small",weight:"bold",content:this.localize("step2Of3")}),(!this.props.eventPageState.isEdit||this.props.eventPageState.isEdit&&this.props.eventPageState.isDraft)&&i.createElement(te.a,{className:"rtl-right-margin-small",disabled:this.state.isLoading,loading:this.state.isLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_draft_button"}),i.createElement(te.a,{content:this.localize("nextButton"),disabled:this.state.isLoading||this.state.eventDetails.audience===V.Private&&0===this.state.selectedUsersAndGroups.length,primary:!0,onClick:this.nextBtnClick,"data-testid":"next_button"})))}}]),a}(i.Component),la=Object(U.a)()(ca),ua=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.teamId=void 0,n.getRegisteredAttendeesCount=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve(Object(oe.a)(n.props.eventPageState.selectedUserGroups));case 2:t=e.sent,n.setState({registeredAttendeesCount:t.mandatoryUsers.length});case 4:case"end":return e.stop()}}),e)}))),n.backBtnClick=function(){n.props.navigateToPage(2,n.props.eventPageState)},n.getArtifacts=function(){var e,t,a=[];switch(null===(e=n.props.eventPageState.eventDetails)||void 0===e?void 0:e.type){case _.Teams:a.push(i.createElement(we,null));break;case _.LiveEvent:a.push(i.createElement(xe,null))}switch(null===(t=n.props.eventPageState.eventDetails)||void 0===t?void 0:t.audience){case V.Private:a.push(i.createElement(ke,{audienceType:V.Private}));break;case V.Public:a.push(i.createElement(ke,{audienceType:V.Public}))}return i.createElement(f.a,{gap:"gap.small",vAlign:"center"},a)},n.getEventDayAndTime=function(e,t,a){var n=R.a.utc(e).local().format("ddd"),r=R.a.utc(t).local().format("HH:mm"),i=R.a.utc(a).local().format("HH:mm");return"".concat(n,", ").concat(r," - ").concat(i)},n.renderEventVenue=function(e,t){if(e===_.InPerson)return i.createElement(i.Fragment,null,i.createElement(ee.a,{vertical:!0,styles:{height:"1.13rem",marginRight:".8rem"}}),i.createElement(b.a,{className:"event-venue",content:t,weight:"semibold",size:"small"}))},n.saveEventAsDraft=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isDraftLoading:!0}),e.next=3,fe(Object(se.a)({},n.props.eventPageState),n.teamId);case 3:e.sent?x.tasks.submitTask({isSuccess:!0,isDraft:!0}):(n.setState({isDraftLoading:!1}),x.tasks.submitTask({isSuccess:!1,isDraft:!0}));case 5:case"end":return e.stop()}}),e)}))),n.createEvent=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isCreateLoading:!0}),e.next=3,ge(n.props.eventPageState,n.teamId);case 3:e.sent?x.tasks.submitTask({isSuccess:!0,isCreateEvent:!0}):(n.setState({isCreateLoading:!1}),x.tasks.submitTask({isSuccess:!1,isCreateEvent:!0}));case 5:case"end":return e.stop()}}),e)}))),n.updateEvent=Object(h.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isCreateLoading:!0}),e.next=3,he(n.props.eventPageState,n.teamId);case 3:e.sent?x.tasks.submitTask({isSuccess:!0}):(n.setState({isCreateLoading:!1}),x.tasks.submitTask({isSuccess:!1}));case 5:case"end":return e.stop()}}),e)}))),n.renderAttendeeURL=function(){if(n.props.eventPageState.eventDetails.type===_.LiveEvent)return i.createElement(f.a,{design:{marginTop:"2.67rem"},vAlign:"center",hAlign:"start",column:!0},i.createElement(b.a,{content:n.localize("liveEventUrlStep1"),weight:"semibold"}),i.createElement("a",{href:n.props.eventPageState.eventDetails.meetingLink,target:"_blank",rel:"noopener noreferrer"},n.props.eventPageState.eventDetails.meetingLink))},n.localize=n.props.t,n.teamId="",n.state={isCreateLoading:!1,registeredAttendeesCount:0,isDraftLoading:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;x.initialize(),x.getContext((function(t){e.teamId=t.teamId})),this.props.eventPageState.eventDetails.audience===V.Private&&this.props.eventPageState.eventDetails.isAutoRegister&&this.getRegisteredAttendeesCount()}},{key:"render",value:function(){var e;return i.createElement(i.Fragment,null,i.createElement("div",{className:"page-content create-event-step3"},i.createElement(f.a,{gap:"gap.smaller"},i.createElement(b.a,{size:"large",content:this.localize("eventPreviewStep3")})),i.createElement(f.a,{className:"margin-top",space:"between",vAlign:"center"},i.createElement(b.a,{className:"category label-color",content:null===(e=this.props.eventPageState.selectedCategory)||void 0===e?void 0:e.header,weight:"bold"}),i.createElement(f.a.Item,{push:this.props.dir===ie.Ltr},this.getArtifacts())),this.props.eventPageState.eventDetails.photo&&i.createElement(Mt.a,{className:"event-image",fluid:!0,src:this.props.eventPageState.eventDetails.photo}),this.props.eventPageState.eventDetails.selectedColor&&i.createElement("div",{className:"event-image",style:{backgroundColor:this.props.eventPageState.eventDetails.selectedColor}},i.createElement(f.a,{className:"event-image-color",hAlign:"center",vAlign:"center"},i.createElement(b.a,{className:"event-color-text",size:"large",weight:"semibold",content:this.props.eventPageState.eventDetails.name}))),i.createElement("div",{style:{marginTop:"1.33rem"}},i.createElement(b.a,{align:this.props.dir===ie.Rtl?"end":"start",content:this.props.eventPageState.eventDetails.name,weight:"bold",size:"medium"})),i.createElement(f.a,{vAlign:"center",hAlign:"start"},i.createElement(X.a,{className:"event-date-and-time",start:i.createElement(re.a,{iconName:"Clock"}),main:i.createElement(b.a,{content:this.getEventDayAndTime(this.props.eventPageState.eventDetails.startDate,this.props.eventPageState.eventDetails.startTime,this.props.eventPageState.eventDetails.endTime),weight:"semibold",size:"small"}),gap:".4rem"}),this.renderEventVenue(this.props.eventPageState.eventDetails.type,this.props.eventPageState.eventDetails.venue)),i.createElement(f.a,{vAlign:"center",hAlign:"start",design:{marginTop:"2.67rem"}},i.createElement(b.a,{align:this.props.dir===ie.Rtl?"end":"start",content:this.props.eventPageState.eventDetails.description})),this.renderAttendeeURL(),i.createElement(f.a,{gap:this.props.dir===ie.Rtl?void 0:"gap.large",design:{marginTop:"2.67rem"}},i.createElement(f.a,{column:!0,className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""},i.createElement(b.a,{align:this.props.dir===ie.Rtl?"end":"start",content:this.localize("totalNoOfParticipants"),weight:"semibold"}),i.createElement(b.a,{align:this.props.dir===ie.Rtl?"end":"start",content:this.props.eventPageState.eventDetails.maximumNumberOfParticipants})),i.createElement(f.a,{column:!0},i.createElement(b.a,{align:this.props.dir===ie.Rtl?"end":"start",content:this.localize("registeredParticipants"),weight:"semibold"}),i.createElement(b.a,{align:this.props.dir===ie.Rtl?"end":"start",content:this.state.registeredAttendeesCount})))),this.props.dir===ie.Ltr&&i.createElement(f.a,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(te.a,{disabled:this.state.isCreateLoading,icon:i.createElement(be.ArrowLeftIcon,null),text:!0,content:this.localize("back"),onClick:this.backBtnClick}),i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{weight:"bold",content:this.localize("step3of3")})),(this.props.eventPageState.isDraft||!this.props.eventPageState.isEdit)&&i.createElement(i.Fragment,null,i.createElement(te.a,{disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isDraftLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_button"}),i.createElement(te.a,{disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isCreateLoading,content:this.localize("createEvent"),primary:!0,onClick:this.createEvent,"data-testid":"create_event_button"})),!this.props.eventPageState.isDraft&&this.props.eventPageState.isEdit&&i.createElement(i.Fragment,null,i.createElement(te.a,{disabled:this.state.isCreateLoading,loading:this.state.isCreateLoading,content:this.localize("updateEventButton"),primary:!0,onClick:this.updateEvent,"data-testid":"update_button"}))),this.props.dir===ie.Rtl&&i.createElement(f.a,{gap:"gap.smaller",className:"button-footer",vAlign:"center"},i.createElement(f.a.Item,{push:!0},i.createElement(te.a,{disabled:this.state.isCreateLoading,icon:i.createElement(be.ArrowRightIcon,null),text:!0,content:i.createElement(b.a,{content:this.localize("back"),className:"rtl-right-margin-small"}),onClick:this.backBtnClick})),i.createElement(b.a,{className:"rtl-left-margin-small",weight:"bold",content:this.localize("step3of3")}),(this.props.eventPageState.isDraft||!this.props.eventPageState.isEdit)&&i.createElement(i.Fragment,null,i.createElement(te.a,{className:"rtl-left-margin-small",disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isDraftLoading,onClick:this.saveEventAsDraft,content:this.localize("saveAsDraft"),secondary:!0,"data-testid":"save_button"}),i.createElement(te.a,{disabled:this.state.isCreateLoading||this.state.isDraftLoading,loading:this.state.isCreateLoading,content:this.localize("createEvent"),primary:!0,onClick:this.createEvent,"data-testid":"create_event_button"})),!this.props.eventPageState.isDraft&&this.props.eventPageState.isEdit&&i.createElement(i.Fragment,null,i.createElement(te.a,{className:"rtl-left-margin-small",disabled:this.state.isCreateLoading,loading:this.state.isCreateLoading,content:this.localize("updateEventButton"),primary:!0,onClick:this.updateEvent,"data-testid":"update_button"}))))}}]),a}(i.Component),da=Object(U.a)()(ye(ua)),ma=function(e){var t=Object(Ze.a)().t,a=i.useState(e.eventDetails),n=Object(Oe.a)(a,2),s=n[0],o=(n[1],i.useState(!1)),c=Object(Oe.a)(o,2),l=c[0],u=(c[1],i.useState(!1)),d=Object(Oe.a)(u,2),m=d[0],p=(d[1],i.useState("")),v=Object(Oe.a)(p,2),y=v[0],C=v[1];i.useEffect((function(){S(e.eventDetails.createdBy)}),[e.eventDetails]),i.useEffect((function(){S(e.eventDetails.createdBy)}),[]);var S=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[t],e.next=3,Q(a);case 3:(n=e.sent).status===r.OK&&n.data&&(i=n.data[0],C(i.displayName));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(e,t,a){var n=R.a.utc(e).local().format("ddd"),r=R.a.utc(t).local().format("HH:mm"),i=R.a.utc(a).local().format("HH:mm");return"".concat(n,", ").concat(r," - ").concat(i)};return l?i.createElement(ne.a,{className:"task-module-loader"}):m?i.createElement(b.a,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):i.createElement("div",{className:"close-cancel-event-container"},i.createElement("div",{className:"close-cancel-event"},i.createElement(f.a,{space:"between",vAlign:"center"},i.createElement(b.a,{className:"category label-color",content:s.categoryName,weight:"bold"}),i.createElement(f.a.Item,{push:!0},s.audience===V.Private?i.createElement(E.a,{className:"category-type-label",circular:!0,icon:i.createElement(be.EyeSlashIcon,null),iconPosition:"start",content:t("private")}):i.createElement(E.a,{className:"category-type-label",circular:!0,icon:i.createElement(be.EyeIcon,null),iconPosition:"start",content:t("public")}))),i.createElement(Mt.a,{className:"event-image",fluid:!0,src:s.photo}),i.createElement("div",{style:{marginTop:"1.33rem"}},i.createElement(b.a,{content:s.name,weight:"bold",size:"medium"})),i.createElement(f.a,{vAlign:"center",hAlign:"start"},i.createElement(X.a,{className:"event-date-and-time",start:i.createElement(re.a,{iconName:"Clock"}),main:i.createElement(b.a,{content:k(s.startDate,s.startTime,s.endTime),weight:"semibold",size:"small"}),gap:".4rem"}),function(e,t){if(e===_.InPerson)return i.createElement(i.Fragment,null,i.createElement(ee.a,{vertical:!0,styles:{height:"1.13rem",marginRight:".8rem"}}),i.createElement(b.a,{className:"event-venue",content:t,weight:"semibold",size:"small"}))}(s.type,s.venue)),i.createElement(f.a,{vAlign:"center",hAlign:"start",design:{marginTop:"2.67rem"}},i.createElement(b.a,{content:s.description})),i.createElement(f.a,{gap:"gap.large",design:{marginTop:"2.67rem"}},i.createElement(f.a,{column:!0},i.createElement(b.a,{content:t("totalNoOfParticipants"),weight:"semibold"}),i.createElement(b.a,{content:s.maximumNumberOfParticipants})),i.createElement(f.a,{column:!0},i.createElement(b.a,{content:t("registeredParticipants"),weight:"semibold"}),i.createElement(b.a,{content:s.registeredAttendeesCount}))),function(){var e=y&&y.length?y:t("unknownUserName");return i.createElement(f.a,{vAlign:"center",hAlign:"start",gap:"gap.smaller",design:{marginTop:"2.67rem"}},i.createElement($.a,{size:"small",name:e}),i.createElement(X.a,{start:i.createElement(b.a,{content:t("createdBy"),size:"small"}),main:i.createElement(b.a,{content:e,size:"small",weight:"semibold"}),gap:".4rem"}))}()))},pa=(a(848),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.minDate=new Date,n.params={eventId:void 0,isDraft:!1},n.teamId=void 0,n.getEventDetailsToUpdate=Object(h.a)(g.a.mark((function e(){var t,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.params.eventId,n.teamId);case 2:(t=e.sent).status===r.OK?(a=t.data,i=Array(),a.selectedUserOrGroupListJSON&&(i=JSON.parse(a.selectedUserOrGroupListJSON)),a.startDate=R.a.utc(a.startDate).local().toDate(),a.endDate=R.a.utc(a.endDate).local().toDate(),a.startTime=R.a.utc(a.startTime).local().toDate(),a.endTime=R.a.utc(a.endTime).local().toDate(),a.status===F.Cancelled||a.endDate<new Date?n.setState({isLoading:!1,displayReadonly:!0,eventDetails:a},n.getAllCategories):n.setState({isLoading:!1,eventDetails:a,selectedUserGroups:i,isEdit:!0,isDraft:n.params.isDraft},n.getAllCategories)):n.setState({isLoading:!1});case 4:case"end":return e.stop()}}),e)}))),n.getAllCategories=Object(h.a)(g.a.mark((function e(){var t,a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe();case 2:(t=e.sent).status===r.OK?(a=t.data.map((function(e){return{name:e.name,id:e.categoryId}})),n.state.eventDetails.categoryId?(s=a.find((function(e){return e.id===n.state.eventDetails.categoryId})),i={header:s.name,key:s.id},n.setState({categories:a,selectedCategory:i,isLoading:!1})):n.setState({categories:a,isLoading:!1})):n.setState({isLoading:!1});case 4:case"end":return e.stop()}}),e)}))),n.setEventStep=function(e,t){n.setState({currentEventStep:e,eventDetails:t.eventDetails,selectedAudience:t.selectedAudience,selectedCategory:t.selectedCategory,selectedEvent:t.selectedEvent,selectedUserGroups:t.selectedUserGroups,categories:t.categories})},n.renderOperation=function(){switch(n.state.currentEventStep){case 1:return i.createElement(ta,{eventPageState:Object(se.a)({},n.state),navigateToPage:n.setEventStep});case 2:return i.createElement(la,{eventPageState:Object(se.a)({},n.state),navigateToPage:n.setEventStep,dir:n.props.dir});case 3:return i.createElement(da,{eventPageState:Object(se.a)({},n.state),navigateToPage:n.setEventStep});default:return i.createElement(ta,{eventPageState:Object(se.a)({},n.state),navigateToPage:n.setEventStep})}},n.localize=n.props.t,n.minDate.setDate(n.minDate.getDate()+1),n.teamId="";var s=window.location.search,o=new URLSearchParams(s);return n.params.eventId=o.get("eventId"),n.params.isDraft="true"===o.get("isDraft"),n.state={currentEventStep:1,categories:new Array,displayReadonly:!1,eventDetails:{categoryId:"",categoryName:"",createdBy:"",createdOn:new Date,description:"",endDate:n.minDate,eventId:"",graphEventId:"",isAutoRegister:!1,isRegistrationClosed:!1,maximumNumberOfParticipants:0,meetingLink:"",name:"",numberOfOccurrences:1,photo:"",registeredAttendeesCount:0,startDate:n.minDate,status:0,teamId:"",type:_.Teams,venue:"",audience:V.Public,endTime:void 0,startTime:void 0,mandatoryAttendees:"",optionalAttendees:"",registeredAttendees:"",selectedUserOrGroupListJSON:"",autoRegisteredAttendees:""},selectedCategory:void 0,selectedEvent:void 0,selectedAudience:void 0,selectedUserGroups:new Array,isEdit:!1,isDraft:!1,isLoading:!0},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.getAllCategories()}},{key:"componentWillReceiveProps",value:function(e){e.teamsContext&&e.teamsContext!==this.props.teamsContext&&(this.teamId=e.teamsContext.teamId,this.params.eventId&&this.getEventDetailsToUpdate())}},{key:"render",value:function(){var e;return this.state.isLoading||(null===(e=this.state.categories)||void 0===e?void 0:e.length)?this.state.displayReadonly?i.createElement(ma,{eventDetails:this.state.eventDetails}):i.createElement(Ie.a,{dir:this.props.dir},i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"task-module-container"},!this.state.isLoading&&!this.state.displayReadonly&&this.renderOperation(),this.state.isLoading&&i.createElement(ne.a,{className:"loader"}))))):i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"task-module-container event-task-module"},i.createElement(b.a,{error:!0,content:this.localize("categoriesNotAvailableError"),weight:"semibold"}))))}}]),a}(i.Component)),va=Object(U.a)()(ye(pa)),ga=a(445),ha=a(417),fa=a(425),Ea=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(I.apiBaseURL,"/category"),n=W({teamId:t}),e.next=4,T.get(a,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ba=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(I.apiBaseURL,"/category/get-categories-for-event"),e.next=3,T.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ya=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/category"),r=W({teamId:t}),e.next=4,T.post(n,a,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ca=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/category"),r=W({teamId:t}),e.next=4,T.patch(n,a,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Sa=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/category"),r=W({teamId:t,categoryIds:a}),e.next=4,T.delete(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ka=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).localize=void 0,s.searchText=void 0,s.getCategoriesAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,n,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ea(t);case 2:(a=e.sent)&&a.status===r.OK?(i=[],null===(n=a.data)||void 0===n||n.forEach((function(e){i.push(e)})),s.setState({categories:i,isLoading:!1})):s.setState({isLoading:!1,statusMessage:s.localize("dataResponseFailedStatus")});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.getLastCategoryUpdateDateAndTime=function(){var e;if(!((null===(e=s.state.categories)||void 0===e?void 0:e.length)>0))return null;var t,a=Object(oe.a)(s.state.categories);a.sort((function(e,t){return e.updatedOn&&t.updatedOn||!e.updatedOn&&t.updatedOn?1:e.updatedOn&&!t.updatedOn?-1:0})),s.localize("lastUpdatedOnStatus",{lastUpdatedOnStatus:null===(t=a[a.length-1].updatedOn)||void 0===t?void 0:t.toUTCString})},s.searchCategories=function(e){var t,a=null!==(t=s.state.categories)&&void 0!==t?t:[];if(a.length>0&&e&&""!==e.trim()){s.searchText=e.trim();var n=a.filter((function(e){return e.name.toLowerCase().indexOf(s.searchText.toLowerCase())>-1||e.description.toLowerCase().indexOf(s.searchText.toLowerCase())>-1}));s.setState({searchedCategories:n})}else s.searchText="",s.setState({categories:a,searchedCategories:[]})},s.onActionPerformed=function(e){if(e===n.Edit||e===n.Delete){var t=s.state.categories.filter((function(e){return e.isSelected}));s.props.onActionPerformed(e,t)}else s.props.onActionPerformed(e)},s.onCategoryCheckedChange=function(e){e.isSelected=!e.isSelected,s.manageControlsEnabilityAndSelection()},s.onSelectAllCategoriesCheckedChange=function(){if(s.state.categories&&s.state.categories.length>0){for(var e=Object(oe.a)(s.state.categories),t=0;t<e.length;t++)e[t].isSelected=!s.state.isAllCategoriesSelected;s.setState({categories:e},(function(){s.manageControlsEnabilityAndSelection()}))}},s.onSearchTextChanged=function(e){s.searchCategories(e.target.value)},s.renderCategoryOperationStatusIcon=function(){if(s.state.showStatusIcon)return i.createElement(ga.a,{className:"success-icon"})},s.renderFooter=function(){if(s.state.statusMessage&&""!==s.state.statusMessage)return i.createElement(i.Fragment,null,i.createElement(f.a,{gap:"gap.small",vAlign:"center",hAlign:"center"},s.renderCategoryOperationStatusIcon(),i.createElement(f.a.Item,{grow:!0},i.createElement(b.a,{"data-testid":"statusmessage",content:s.state.statusMessage,weight:"semibold"}))),i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{timestamp:!0,content:s.getLastCategoryUpdateDateAndTime(),weight:"semibold"})))},s.renderCategories=function(){if(s.state.isLoading)return i.createElement(f.a,{className:"task-module-loader",hAlign:"center",vAlign:"center",fill:!0},i.createElement(ne.a,null));var e=""!==s.searchText?s.state.searchedCategories:s.state.categories;if((null===e||void 0===e?void 0:e.length)>0){var t={key:"header",items:[{key:"select-all-categories",className:"category-select-all-column",content:i.createElement(Ye.a,{"data-testid":"list-categories_selectAllCheckbox",key:"categoriesTableHeader",checked:s.state.isAllCategoriesSelected,onChange:s.onSelectAllCategoriesCheckedChange})},{key:"category-name",className:"category-name-column",content:s.localize("categoryName")},{key:"category-description",content:s.localize("description")}]},a=e.map((function(e,t){return{key:t,items:[{className:"category-select-all-column",content:i.createElement(Ye.a,{"data-testid":"list-categories_categoryCheckbox"+t.toString(),key:t,checked:e.isSelected,onChange:function(){return s.onCategoryCheckedChange(e)}})},{className:"category-name-column",content:i.createElement(b.a,{content:e.name,weight:"bold"}),title:e.name,truncateContent:!0},{content:e.description,title:e.description,truncateContent:!0}]}}));return i.createElement(Dt.a,{"data-testid":"table",className:"manage-categories-content categories-table manage-categories-content-background",header:t,rows:a})}return i.createElement(f.a,{className:"manage-categories-content",gap:"gap.small"},i.createElement(f.a.Item,null,i.createElement("div",{style:{position:"relative"}},i.createElement(ra.a,{outline:!0,color:"green"}))),i.createElement(f.a.Item,{grow:s.props.dir===ie.Ltr},i.createElement(f.a,{column:!0,gap:"gap.small",vAlign:"stretch"},i.createElement("div",{className:s.props.dir===ie.Rtl?"rtl-direction rtl-right-margin-small":""},i.createElement(b.a,{weight:"bold",content:s.localize("categoriesNotAvailableHeader")}),i.createElement("br",null),i.createElement(b.a,{content:""!==s.searchText?s.localize("categoriesNotFoundForSearchedTextDescription",{searchedText:s.searchText}):s.localize("categoriesNotAvailableHeaderDescription")})))))},s.renderSearchInput=function(){return s.props.dir===ie.Rtl?i.createElement("div",null,i.createElement(ze.a,{icon:i.createElement(qe.a,null),iconPosition:"start","data-testid":"searchbar",placeholder:s.localize("searchPlaceholder"),onChange:s.onSearchTextChanged})):s.props.dir===ie.Ltr?i.createElement(ze.a,{icon:i.createElement(qe.a,null),iconPosition:"end","data-testid":"searchbar",placeholder:s.localize("searchPlaceholder"),onChange:s.onSearchTextChanged}):void 0},s.localize=s.props.t,s.searchText="",s.state={isEditEnabled:!1,isDeleteEnabled:!1,isAllCategoriesSelected:!1,categories:[],searchedCategories:[],statusMessage:s.props.statusMessage,isLoading:!1,showStatusIcon:""!==s.props.statusMessage&&s.props.statusMessage.length>0},s}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0})}},{key:"componentWillReceiveProps",value:function(e){this.props.teamsContext!==e.teamsContext&&e.teamsContext&&this.getCategoriesAsync(e.teamsContext.teamId)}},{key:"manageControlsEnabilityAndSelection",value:function(){var e,t=null===(e=this.state.categories.filter((function(e){return e.isSelected})))||void 0===e?void 0:e.length,a="",n=t===this.state.categories.length;1===t?(a=this.localize("listCategoriesSelectedStatus",{selectedCategoriesCount:t,totalCategoriesCount:this.state.categories.length}),this.setState({isEditEnabled:!0,isDeleteEnabled:!0,isAllCategoriesSelected:n,statusMessage:a,showStatusIcon:!1})):t>1?(a=this.localize("listCategoriesSelectedStatus",{selectedCategoriesCount:t,totalCategoriesCount:this.state.categories.length}),this.setState({isEditEnabled:!1,isDeleteEnabled:!0,isAllCategoriesSelected:n,statusMessage:a,showStatusIcon:!1})):this.setState({isEditEnabled:!1,isDeleteEnabled:!1,isAllCategoriesSelected:n,statusMessage:a,showStatusIcon:!1})}},{key:"render",value:function(){var e=this;return i.createElement(i.Fragment,null,i.createElement("div",{className:"commandbar-wrapper"},i.createElement(f.a,{className:"commandbar-wrapper-container"},i.createElement(te.a,{text:!0,"data-testid":"addbutton",className:"list-categories-menu-button",icon:i.createElement(ha.a,{className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""}),content:this.localize("add"),onClick:function(){return e.onActionPerformed(n.Add)}}),i.createElement(te.a,{text:!0,"data-testid":"editbutton",className:"list-categories-menu-button",icon:i.createElement(fa.a,{className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""}),disabled:!this.state.isEditEnabled,content:this.localize("edit"),onClick:function(){return e.onActionPerformed(n.Edit)}}),i.createElement(te.a,{text:!0,"data-testid":"deletebutton",icon:i.createElement(na.a,{className:this.props.dir===ie.Rtl?"rtl-left-margin-small":""}),disabled:!this.state.isDeleteEnabled,content:this.localize("delete"),onClick:function(){return e.onActionPerformed(n.Delete)}}),i.createElement(f.a.Item,{push:this.props.dir===ie.Ltr,grow:this.props.dir===ie.Rtl,className:"search-input-container"},this.renderSearchInput()))),this.renderCategories(),i.createElement(f.a,{className:"manage-categories-footer",space:"between"},this.renderFooter()))}}]),a}(i.Component),wa=Object(U.a)()(ye(ka)),xa=function(e){return i.createElement(f.a,{className:"manage-categories-footer",space:"between"},i.createElement(te.a,{"data-testid":"backbutton",className:"back-button",text:!0,icon:e.dir===ie.Rtl?i.createElement(be.ChevronEndIcon,null):i.createElement(be.ChevronStartIcon,null),content:e.backButtonContent,onClick:e.onBackClicked}),i.createElement(f.a,{gap:"gap.medium",vAlign:"center",hAlign:"center"},function(){if(e.errorMessage&&""!==e.errorMessage)return i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{error:!0,content:e.errorMessage,weight:"semibold"}))}(),i.createElement(f.a.Item,{push:!0},i.createElement(te.a,{primary:!0,content:e.submitButtonContent,disabled:e.isSubmitButtonDisabled,loading:e.isOperationInProgress,onClick:e.onSubmit,"data-testid":"manage-categories-operation-footer_button"}))))},Da=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n,s;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.teamId=void 0,n.createOrUpdateCategoryAsync=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({isCreatingOrUpdating:!0,errorMessage:""}),!1,n.props.category&&n.props.category.name===n.state.category.name.trim()){e.next=9;break}return e.next=5,n.checkCategoryExists();case 5:if(!e.sent){e.next=9;break}return n.setState({isCategoryAlreadyExists:!0,isCreatingOrUpdating:!1}),e.abrupt("return");case 9:if(!n.props.category){e.next=16;break}return e.next=12,Ca(n.teamId,n.state.category);case 12:(t=e.sent).status==r.OK?1==t.data?n.props.onCategoryAddedOrUpdated(n.localize("categoryUpdateSuccess")):n.setState({isCreatingOrUpdating:!1,errorMessage:n.localize("failedToUpdateCategory")}):n.setState({isCreatingOrUpdating:!1,errorMessage:n.localize("dataResponseFailedStatus")}),e.next=20;break;case 16:return e.next=18,ya(n.teamId,n.state.category);case 18:(t=e.sent).status==r.OK&&!0===t.data?(n.setState({isCreatingOrUpdating:!1,errorMessage:""}),n.props.onCategoryAddedOrUpdated(n.localize("categoryAddedSuccess"))):n.setState({isCreatingOrUpdating:!1,errorMessage:n.localize("dataResponseFailedStatus")});case 20:case"end":return e.stop()}}),e)}))),n.checkCategoryExists=Object(h.a)(g.a.mark((function e(){var t,a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(t=n.state.category.name)||void 0===t?void 0:t.length)){e.next=15;break}return e.next=3,ba();case 3:if(!(a=e.sent)||a.status!==r.OK||!a.data){e.next=12;break}if((i=a.data)&&0!==i.length){e.next=8;break}return e.abrupt("return",!1);case 8:return s=i.some((function(e){return e.name.toLowerCase()===n.state.category.name.trim().toLowerCase()})),e.abrupt("return",s);case 12:return e.abrupt("return",!1);case 13:e.next=16;break;case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)}))),n.onNameChanged=function(e){var t=n.state.category;t.name=e.target.value,n.setState({category:t,isCategoryAlreadyExists:!1})},n.onDescriptionChanged=function(e){var t=n.state.category;t.description=e.target.value,n.setState({category:t})},n.renderCategoryNameError=function(){if(n.state.isCategoryAlreadyExists)return i.createElement(f.a.Item,{push:!0},i.createElement(b.a,{error:!0,content:n.localize("categoryAlreadyExistsError"),weight:"semibold"}))},n.localize=n.props.t,n.teamId="",s=n.props.category?Object(se.a)({},n.props.category):{categoryId:"",name:"",description:"",isSelected:!1,isInUse:!1},n.state={category:s,isCreatingOrUpdating:!1,errorMessage:"",isCategoryAlreadyExists:!1},n}return Object(u.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.props.teamsContext!==e.teamsContext&&e.teamsContext&&(this.teamId=e.teamsContext.teamId,this.props.category&&this.setState({category:Object(se.a)({},this.props.category)}))}},{key:"render",value:function(){return i.createElement(i.Fragment,null,i.createElement(f.a,{column:!0,gap:"gap.medium","data-testid":"addorupdateform"},i.createElement(f.a,{column:!0,gap:"gap.smaller"},i.createElement(f.a,{space:"between"},i.createElement(b.a,{content:"".concat(this.localize("categoryName"),"*"),weight:"semibold"}),this.renderCategoryNameError()),i.createElement(ze.a,{fluid:!0,required:!0,placeholder:this.localize("enterNamePlaceholder"),value:this.state.category.name,maxLength:I.categoryNameMaxLength,onChange:this.onNameChanged,"data-testid":"categoryname"})),i.createElement(f.a,{column:!0,gap:"gap.smaller"},i.createElement(b.a,{content:"".concat(this.localize("description"),"*"),weight:"semibold"}),i.createElement(Rt.a,{className:"add-update-category-description",fluid:!0,placeholder:this.localize("categoryDescriptionPlaceholder",{categoryDescriptionMaxLength:I.categoryDescriptionMaxLength}),maxLength:I.categoryDescriptionMaxLength,value:this.state.category.description,onChange:this.onDescriptionChanged,"data-testid":"categorydescription"})),i.createElement(xa,{dir:this.props.dir,backButtonContent:this.localize("back"),submitButtonContent:this.props.category?this.localize("save"):this.localize("addCategory"),isSubmitButtonDisabled:""===this.state.category.name.trim()||""===this.state.category.description.trim()||this.state.isCreatingOrUpdating||this.state.isCategoryAlreadyExists,isOperationInProgress:this.state.isCreatingOrUpdating,errorMessage:this.state.errorMessage,onBackClicked:this.props.onBackClicked,onSubmit:this.createOrUpdateCategoryAsync})))}}]),a}(i.Component),Oa=Object(U.a)()(ye(Da)),Ta=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=n.props.t,n.teamId=void 0,n.deleteCategoryAsync=Object(h.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isDeleting:!0,errorMessage:""}),t=n.props.categories.map((function(e){return e.categoryId})),e.next=4,Sa(n.teamId,t.join(","));case 4:(a=e.sent).status===r.OK?!0===a.data?n.props.onCategoryDeleted(n.localize("categoryDeleteSuccess")):n.setState({isDeleting:!1,errorMessage:n.localize("failedToDeleteCategory")}):n.setState({isDeleting:!1,errorMessage:n.localize("dataResponseFailedStatus")});case 6:case"end":return e.stop()}}),e)}))),n.renderCategories=function(){if(n.props.categories&&n.props.categories.length>0){var e={key:"header",items:[{key:"category-name",className:"category-name-column",content:n.localize("categoryName")},{key:"category-description",content:n.localize("description")}]},t=n.props.categories.map((function(e,t){return{key:t,items:[{className:"category-select-all-column",content:e.isInUse?i.createElement(be.ExclamationCircleIcon,{title:n.localize("categoryInUse"),style:{paddingLeft:".42rem"}}):""},{className:"category-name-column",content:i.createElement(b.a,{content:e.name,weight:"bold"}),title:e.name,truncateContent:!0},{content:e.description,title:e.description,truncateContent:!0}]}}));return i.createElement(Dt.a,{className:"manage-categories-content categories-table manage-categories-content-background",header:e,rows:t,"data-testid":"deletecategorytable"})}},n.teamId="",n.state={isDeleting:!1,errorMessage:""},n}return Object(u.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.props.teamsContext!==e.teamsContext&&e.teamsContext&&(this.teamId=e.teamsContext.teamId)}},{key:"render",value:function(){return i.createElement(i.Fragment,null,i.createElement(b.a,{content:this.localize("deleteCategoryConfirmation"),weight:"semibold"}),this.renderCategories(),i.createElement(xa,{dir:this.props.dir,backButtonContent:this.localize("back"),submitButtonContent:this.localize("delete"),isSubmitButtonDisabled:this.state.isDeleting,isOperationInProgress:this.state.isDeleting,errorMessage:this.state.errorMessage,onBackClicked:this.props.onBackClicked,onSubmit:this.deleteCategoryAsync}))}}]),a}(i.Component),Ia=Object(U.a)()(ye(Ta)),Na=(a(849),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).localize=void 0,r.setCategoryOperation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.Unknown,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];r.setState({operation:t,operationData:a,operationStatusMessage:e})},r.onBackClicked=function(){r.setCategoryOperation()},r.onOperationSuccessful=function(e){r.setCategoryOperation(e)},r.onCategoryActionPerformed=function(e,t){r.setCategoryOperation("",e,t)},r.renderOperation=function(){var e;switch(r.state.operation){case n.Add:return i.createElement(Oa,{onBackClicked:r.onBackClicked,onCategoryAddedOrUpdated:r.onOperationSuccessful});case n.Edit:return i.createElement(Oa,{category:null===(e=r.state.operationData)||void 0===e?void 0:e[0],onBackClicked:r.onBackClicked,onCategoryAddedOrUpdated:r.onOperationSuccessful});case n.Delete:return i.createElement(Ia,{categories:r.state.operationData,onBackClicked:r.onBackClicked,onCategoryDeleted:r.onOperationSuccessful});default:return i.createElement(wa,{statusMessage:r.state.operationStatusMessage,onActionPerformed:r.onCategoryActionPerformed})}},r.localize=r.props.t,r.state={operation:n.Unknown,operationData:[],operationStatusMessage:""},r}return Object(u.a)(a,[{key:"render",value:function(){return i.createElement(Ie.a,{dir:this.props.dir},i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"task-module-container"},this.renderOperation()))))}}]),a}(i.Component)),La=Object(U.a)()(ye(Na)),Pa=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).localize=void 0,n.isMobileView=void 0,n.getEventDetailsAsync=Object(h.a)(g.a.mark((function e(){var t,a,i,s,o,c,l,u,d,m;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new URLSearchParams(window.location.search),o=null!==(t=s.get("operationType"))&&void 0!==t?t:"0",c=null!==(a=s.get("eventId"))&&void 0!==a?a:"0",l=null!==(i=s.get("teamId"))&&void 0!==i?i:"0",n.isMobileView="true"===s.get("isMobileView"),e.next=7,It(c,l);case 7:(u=e.sent).status===r.OK&&u.data?(d=u.data,m=j.None,d.status===F.Active&&new Date<R.a.utc(d.endDate).local().toDate()&&(o===j.CloseRegistration.toString()?d.isRegistrationClosed||(m=j.CloseRegistration):o===j.CancelEvent.toString()&&(m=j.CancelEvent)),n.setState({isLoading:!1,eventDetails:d,eventOperationType:m},(function(){n.state.eventDetails&&n.getUserProfileAsync(n.state.eventDetails.createdBy)}))):n.setState({isLoading:!1,isErrorGettingEventDetails:!0});case 9:case"end":return e.stop()}}),e)}))),n.getUserProfileAsync=function(){var e=Object(h.a)(g.a.mark((function e(t){var a,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[t],e.next=3,Q(a);case 3:(i=e.sent).status===r.OK&&i.data&&(s=i.data[0],n.setState({eventCreatedBy:s.displayName}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onCloseOrCancelEvent=Object(h.a)(g.a.mark((function e(){var t,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({isFailedToCloseOrCancelEvent:!1,isOperationInProgress:!0}),a=n.state.eventDetails?n.state.eventDetails.teamId:"0",i=n.state.eventDetails?n.state.eventDetails.eventId:"0",e.t0=n.state.eventOperationType,e.next=e.t0===j.CloseRegistration?6:e.t0===j.CancelEvent?10:14;break;case 6:return e.next=8,Nt(a,i);case 8:return t=e.sent,e.abrupt("break",15);case 10:return e.next=12,Lt(a,i);case 12:return t=e.sent,e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:t&&t.status===r.OK&&!0===t.data?n.props.microsoftTeams.tasks.submitTask({isSuccess:!0}):n.setState({isFailedToCloseOrCancelEvent:!0,isOperationInProgress:!1});case 16:case"end":return e.stop()}}),e)}))),n.localize=n.props.t,n.isMobileView=!1,n.state={isLoading:!0,isOperationInProgress:!1,eventDetails:void 0,eventCreatedBy:"",isErrorGettingEventDetails:!1,isFailedToCloseOrCancelEvent:!1,eventOperationType:j.None},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.getEventDetailsAsync()}},{key:"render",value:function(){return i.createElement(Ne,{dir:this.props.dir,eventDetails:this.state.eventDetails,eventCreatedByName:this.state.eventCreatedBy,eventOperationType:this.state.eventOperationType,isLoadingEventDetails:this.state.isLoading,isFailedToGetEventDetails:this.state.isErrorGettingEventDetails,isOperationInProgress:this.state.isOperationInProgress,isOperationFailed:this.state.isFailedToCloseOrCancelEvent,isMobileView:this.isMobileView,onPerformOperation:this.onCloseOrCancelEvent})}}]),a}(i.Component),Aa=Object(U.a)()(ye(Pa)),za=function(e){var t=Object(Ze.a)().t,a=window.location.search,n=new URLSearchParams(a),s=n.get("eventId"),o=n.get("teamId"),c=i.useState(!1),l=Object(Oe.a)(c,2),u=l[0],d=l[1],m=i.useState(!1),p=Object(Oe.a)(m,2),v=p[0],E=(p[1],i.useState(!1)),y=Object(Oe.a)(E,2),C=y[0],S=y[1],k=function(){var e=Object(h.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!1),d(!0),e.next=4,Pt(o,s);case 4:(t=e.sent)&&t.status===r.OK&&!0===t.data?(d(!1),x.tasks.submitTask({isSuccess:!0})):(d(!1),S(!0));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return v?i.createElement(b.a,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):i.createElement(ae.a,null,i.createElement(f.a,null,i.createElement("div",{className:"task-module-container close-cancel-event-container"},i.createElement("div",{className:"close-cancel-event"},i.createElement(b.a,{weight:"bold",content:t("deleteConfirmationText")})),i.createElement(f.a,{styles:{marginRight:"3.4rem",marginLeft:"3.4rem",margintop:"2rem",position:"absolute",bottom:"3.4rem"},vAlign:"center"},C?i.createElement(b.a,{error:!0,content:t("dataResponseFailedStatus"),weight:"semibold"}):null,i.createElement(f.a.Item,{push:!0},i.createElement(te.a,{primary:!0,loading:u,disabled:u,content:t("delete"),onClick:k}))))))},ja=(a(850),function(e){var t=Object(Ze.a)().t;return i.createElement("div",{className:"sign-in-content-container"},i.createElement("div",null),i.createElement(b.a,{content:t("signInMessage"),size:"medium"}),i.createElement("div",{className:"space"}),i.createElement(te.a,{content:t("signInText"),primary:!0,className:"sign-in-button",onClick:function(){x.initialize(),x.authentication.authenticate({url:window.location.origin+"/signin-simple-start",successCallback:function(){console.log("Login succeeded!"),window.location.href="/discover"},failureCallback:function(e){console.log("Login failed: "+e),window.location.href="/errorpage"}})}}))}),Fa=function(){var e=Object(h.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(I.apiBaseURL,"/authenticationMetadata/consentUrl"),r=W({windowLocationOriginDomain:t,loginhint:a}),e.next=4,T.get(n,r,!1);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ma=function(){return Object(i.useEffect)((function(){x.initialize(),x.getContext((function(e){var t=window.location.origin.replace("https://",""),a=e.upn?e.upn:"";Fa(t,a).then((function(e){window.location.assign(e.data)}))}))})),s.a.createElement(s.a.Fragment,null)},Ba=function(){return Object(i.useEffect)((function(){x.initialize();var e=function(){var e={};return window.location.hash.substr(1).split("&").forEach((function(t){var a=t.split("="),n=a[0],r=a[1]&&decodeURIComponent(a[1]);e[n]=r})),e}();e.error?x.authentication.notifyFailure(e.error):e.id_token?(x.authentication.notifySuccess(),window.location.href="/"):x.authentication.notifyFailure("UnexpectedFailure")})),s.a.createElement(s.a.Fragment,null)},Ra=function(){return i.createElement(i.Suspense,{fallback:i.createElement("div",{className:"container-div"},i.createElement("div",{className:"container-subdiv"}))},i.createElement(c.a,null,i.createElement(p.c,null,i.createElement(p.a,{exact:!0,path:"/discover-events",component:ht}),i.createElement(p.a,{exact:!0,path:"/my-events",component:Et}),i.createElement(p.a,{exact:!0,path:"/manage-events",component:Ft}),i.createElement(p.a,{exact:!0,path:"/manage-categories",component:La}),i.createElement(p.a,{exact:!0,path:"/close-or-cancel-event",component:Aa}),i.createElement(p.a,{exact:!0,path:"/register-remove",component:Pe}),i.createElement(p.a,{exact:!0,path:"/create-event",component:va}),i.createElement(p.a,{exact:!0,path:"/delete-draft",component:za}),i.createElement(p.a,{exact:!0,path:"/mobile-filter",component:kt}),i.createElement(p.a,{exact:!0,path:"/signin",component:ja}),i.createElement(p.a,{exact:!0,path:"/signin-simple-start",component:Ma}),i.createElement(p.a,{exact:!0,path:"/signin-simple-end",component:Ba}),i.createElement(p.a,{exact:!0,path:"/error",component:C}))))},Ua=(a(852),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).theme=null,n.setThemeComponent=function(){return n.state.theme===I.dark?n.getAppDOM(be.themes.teamsDark,"dark-container"):n.state.theme===I.contrast?n.getAppDOM(be.themes.teamsHighContrast,"high-contrast-container"):n.getAppDOM(be.themes.teams,"default-container")},n.getAppDOM=function(e,t){return i.createElement(ae.a,{theme:e},i.createElement("div",{className:t},i.createElement("div",{className:"appContainer"},i.createElement(Ra,null))))};var r=window.location.search,s=new URLSearchParams(r);return n.theme=s.get("theme"),Object(He.a)(),n.state={theme:n.theme?n.theme:I.default},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;x.initialize(),x.getContext((function(t){e.setState({theme:t.theme})})),x.registerOnThemeChangeHandler((function(t){e.setState({theme:t},(function(){e.forceUpdate()}))}))}},{key:"render",value:function(){return i.createElement("div",null,this.setThemeComponent())}}]),a}(i.Component));o.render(i.createElement(c.a,null,i.createElement(Ua,null)),document.getElementById("root"))}},[[677,1,2]]]);
//# sourceMappingURL=main.0a27cf3f.chunk.js.map